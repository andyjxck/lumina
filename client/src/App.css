/* Glassmorphism Base Styles */
* {
  box-sizing: border-box;
}

/* Notification Styles */
.notification-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 9999;
  pointer-events: none;
}

.notification {
  background: linear-gradient(160deg, rgba(14,28,12,0.95) 0%, rgba(8,18,8,0.93) 100%);
  backdrop-filter: blur(32px) saturate(180%);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 12px;
  padding: 16px 20px;
  margin-bottom: 12px;
  color: white;
  font-size: 14px;
  font-weight: 500;
  pointer-events: all;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.22,1,0.36,1);
  animation: notification-slide-in 0.3s cubic-bezier(0.22,1,0.36,1);
  max-width: 320px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.3);
}

.notification:hover {
  transform: translateX(-4px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.4);
}

.notification-info {
  border-left: 4px solid #3b82f6;
}

.notification-success {
  border-left: 4px solid #10b981;
}

.notification-warning {
  border-left: 4px solid #f59e0b;
}

.notification-error {
  border-left: 4px solid #ef4444;
}

@keyframes notification-slide-in {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@media (max-width: 768px) {
  .notification-container {
    top: auto;
    bottom: 20px;
    right: 20px;
    left: 20px;
  }
  
  .notification {
    max-width: none;
  }
}

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #1e1b4b 100%);
  min-height: 100vh;
  color: white;
  overflow-x: hidden;
  position: relative;
}

/* Background image overlay - ON TOP of gradient */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: var(--bg-image, url('./bg.png'));
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0.03;
  z-index: 10001;
  pointer-events: none;
}

/* Ensure content is above background */
.app-layout, .min-h-screen, .app-bg {
  position: relative;
  z-index: 10000;
}

.min-h-screen {
  min-height: 100vh;
}

.bg-gradient-to-br {
  background:
    radial-gradient(ellipse at 15% 15%, rgba(90, 50, 180, 0.18) 0%, transparent 45%),
    radial-gradient(ellipse at 85% 80%, rgba(40, 80, 180, 0.12) 0%, transparent 45%),
    linear-gradient(160deg, #060410 0%, #08091a 50%, #050b14 100%);
  min-height: 100vh;
}

/* Navigation - No Box Style */
.nav-glass {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 9999px;
  padding: 8px 20px;
  box-shadow: 0 4px 20px 0 rgba(31, 38, 135, 0.2);
}

.nav-icon-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  padding: 4px 6px;
  border-radius: 12px;
  transition: background 0.2s;
  cursor: pointer;
}

.nav-icon-wrap:hover {
  background: rgba(255, 255, 255, 0.1);
}

.nav-icon {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  font-size: 16px;
  color: white;
}

.nav-icon:hover {
  transform: scale(1.05);
}

.nav-icon.active {
  background: rgba(255, 255, 255, 0.2);
  box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
}

.nav-label {
  font-size: 9px;
  color: rgba(255, 255, 255, 0.6);
  font-weight: 500;
  letter-spacing: 0.3px;
  opacity: 0;
  transition: opacity 0.2s;
  white-space: nowrap;
}

.nav-icon-wrap:hover .nav-label {
  opacity: 1;
}

/* Always show labels on mobile */
@media (max-width: 768px) {
  .nav-label {
    opacity: 1;
  }
}

.basket-count {
  background: rgba(255, 255, 255, 0.15);
  border-radius: 9999px;
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 600;
  color: white;
}

/* Search - No Box Style */
.search-glass {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 20px;
  padding: 12px 20px;
  box-shadow: 0 4px 20px 0 rgba(31, 38, 135, 0.2);
  transition: all 0.3s ease;
}

.search-glass:focus-within {
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.2);
  box-shadow: 0 4px 20px 0 rgba(31, 38, 135, 0.3);
}

.search-input {
  width: 100%;
  background: transparent;
  color: white;
  outline: none;
  border: none;
  font-size: 16px;
}

.search-input::placeholder {
  color: rgba(255, 255, 255, 0.7);
}

/* Search Dropdown */
.search-dropdown {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  margin-top: 8px;
  padding: 8px;
  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.3);
  max-height: 400px;
  overflow-y: auto;
}

.search-result {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-radius: 12px;
  margin-bottom: 4px;
  background: rgba(255, 255, 255, 0.05);
  transition: all 0.2s ease;
  cursor: pointer;
}

.search-result:hover {
  background: rgba(255, 255, 255, 0.1);
}

.search-result-info {
  flex: 1;
}

.search-result-name {
  color: white;
  font-weight: 600;
  font-size: 14px;
  margin-bottom: 4px;
}

.search-result-traits {
  color: rgba(255, 255, 255, 0.8);
  font-size: 12px;
}

.search-add-btn {
  background: rgba(255, 255, 255, 0.15);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 8px;
  padding: 6px 12px;
  color: white;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.search-add-btn:hover {
  background: rgba(255, 255, 255, 0.25);
}

.search-add-btn.added {
  background: rgba(34, 197, 94, 0.3);
  border-color: rgba(34, 197, 94, 0.4);
}

/* Filter Bar */
.filter-bar {
  display: flex;
  gap: 12px;
  align-items: center;
  flex-wrap: wrap;
  justify-content: center;
}

.filter-pill-wrap {
  position: relative;
}

.filter-pill {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 9999px;
  padding: 8px 18px;
  color: rgba(255, 255, 255, 0.85);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 6px;
  white-space: nowrap;
}

.filter-pill:hover {
  background: rgba(255, 255, 255, 0.14);
  color: white;
}

.filter-pill.active {
  background: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.3);
  color: white;
  box-shadow: 0 0 16px rgba(255, 255, 255, 0.15);
}

.filter-badge {
  background: rgba(255, 255, 255, 0.3);
  border-radius: 9999px;
  padding: 1px 7px;
  font-size: 11px;
  font-weight: 700;
}

/* Filter Dropdown */
.filter-dropdown {
  position: absolute;
  top: calc(100% + 8px);
  left: 0;
  background: rgba(30, 20, 60, 0.7);
  backdrop-filter: blur(30px);
  -webkit-backdrop-filter: blur(30px);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 16px;
  padding: 12px;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
  z-index: 100;
  min-width: 280px;
}

.filter-dropdown-clear {
  color: rgba(255, 255, 255, 0.5);
  font-size: 11px;
  text-align: right;
  cursor: pointer;
  margin-bottom: 8px;
  padding: 0 4px;
  transition: color 0.2s;
}

.filter-dropdown-clear:hover {
  color: rgba(255, 255, 255, 0.9);
}

/* Icon grid inside dropdown */
.filter-icon-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 6px;
}

.filter-icon-grid.compact {
  grid-template-columns: repeat(4, 1fr);
}

.filter-icon-btn {
  background: rgba(255, 255, 255, 0.06);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 10px;
  padding: 8px 4px;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  color: white;
}

.filter-icon-btn:hover {
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.2);
  transform: translateY(-2px);
}

.filter-icon-btn.active {
  background: rgba(167, 139, 250, 0.3);
  border-color: rgba(167, 139, 250, 0.5);
  box-shadow: 0 0 12px rgba(167, 139, 250, 0.3);
}

.filter-icon-emoji {
  font-size: 20px;
  line-height: 1;
}

.filter-icon-label {
  font-size: 9px;
  color: rgba(255, 255, 255, 0.7);
  text-align: center;
  line-height: 1.2;
  word-break: break-word;
}

.filter-icon-btn.active .filter-icon-label {
  color: rgba(255, 255, 255, 0.95);
}

/* Clear all button */
.filter-clear-all {
  background: rgba(239, 68, 68, 0.15);
  border: 1px solid rgba(239, 68, 68, 0.25);
  border-radius: 9999px;
  padding: 8px 16px;
  color: rgba(255, 180, 180, 0.9);
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-clear-all:hover {
  background: rgba(239, 68, 68, 0.25);
  color: white;
}

/* Villager Grid - No Box Style */
.villager-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 16px;
  align-items: start;
}

.villager-tile {
  background: rgba(255, 255, 255, 0.055);
  backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px);
  border: 1px solid rgba(255, 255, 255, 0.09);
  border-radius: 18px;
  padding: 14px 14px 44px;
  cursor: pointer;
  transition: transform 0.22s cubic-bezier(0.22,1,0.36,1), background 0.18s, box-shadow 0.22s cubic-bezier(0.22,1,0.36,1), border-color 0.18s;
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  min-height: 100px;
}

.villager-tile:hover {
  background: rgba(255, 255, 255, 0.09);
  transform: translateY(-5px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.45), 0 2px 8px rgba(0,0,0,0.2);
  border-color: rgba(255,255,255,0.14);
}

.villager-tile.selected {
  background: rgba(34, 197, 94, 0.15);
  border-color: rgba(34, 197, 94, 0.3);
  box-shadow: 0 0 25px rgba(34, 197, 94, 0.2);
}

/* Self-marked owned: subtle light green border */
.villager-tile.owned,
.podium-card.owned {
  border-color: rgba(34, 197, 94, 0.25);
  box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.12) inset;
}

.villager-tile.owned .villager-icon-wrap,
.podium-card.owned .podium-card-icon {
  background: rgba(34, 197, 94, 0.1) !important;
  border-color: rgba(34, 197, 94, 0.4) !important;
}

/* Trade-confirmed owned: solid bright green border + glow */
.villager-tile.confirmed-owned,
.podium-card.confirmed-owned {
  border-color: rgba(34, 197, 94, 0.7);
  box-shadow: 0 0 12px rgba(34, 197, 94, 0.25), 0 0 0 1px rgba(34, 197, 94, 0.2) inset;
}

.villager-tile.confirmed-owned .villager-icon-wrap,
.podium-card.confirmed-owned .podium-card-icon {
  background: rgba(34, 197, 94, 0.18) !important;
  border-color: rgba(34, 197, 94, 0.85) !important;
  box-shadow: 0 0 14px rgba(34, 197, 94, 0.4) !important;
}

.villager-tile.unavailable {
  opacity: 0.4;
  cursor: not-allowed;
  filter: grayscale(40%);
}

.villager-tile.unavailable:hover {
  transform: none;
  box-shadow: none;
}

.unavailable-label {
  color: rgba(255, 100, 100, 0.9);
  font-size: 11px;
  font-weight: 500;
  margin-top: 6px;
  letter-spacing: 0.3px;
}

.villager-icon-wrap {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
  flex-shrink: 0;
  transition: transform 0.2s ease;
  position: relative;
}

.villager-icon-emoji {
  filter: brightness(0);
}

.villager-icon-wrap.gender-female {
  background: rgba(240, 0, 200, 0.18);
  border: 2px solid #f000c8;
  box-shadow: 0 0 14px rgba(240, 0, 200, 0.45);
}

.villager-icon-wrap.gender-male {
  background: rgba(60, 130, 255, 0.2);
  border: 1.5px solid rgba(60, 130, 255, 0.5);
  box-shadow: 0 0 18px rgba(60, 130, 255, 0.35);
}

.villager-tile:hover .villager-icon-wrap {
  transform: scale(1.08);
}

.villager-tile.selected .villager-icon-wrap.gender-female {
  background: rgba(240, 0, 200, 0.35);
  border-color: #f000c8;
  box-shadow: 0 0 20px rgba(240, 0, 200, 0.7);
}

.villager-tile.selected .villager-icon-wrap.gender-male {
  background: rgba(60, 130, 255, 0.35);
  border-color: rgba(60, 130, 255, 0.7);
}

.villager-top-row {
  display: flex;
  align-items: center;
  gap: 6px;
  width: 100%;
  min-width: 0;
}

.villager-name-col {
  flex: 1;
  min-width: 0;
  overflow: hidden;
}

.villager-name {
  color: rgba(255,255,255,0.95);
  font-size: 12px;
  font-weight: 700;
  margin: 0;
  line-height: 1.3;
  letter-spacing: -0.1px;
  white-space: normal;
  word-break: break-word;
  max-width: 100%;
}

.personality-badge {
  position: absolute;
  bottom: -4px;
  right: -4px;
  font-size: 11px;
  background: rgba(0,0,0,0.45);
  backdrop-filter: blur(6px);
  border-radius: 50%;
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  border: 1px solid rgba(255,255,255,0.15);
}

.selected-dot {
  font-size: 14px;
  color: rgba(34, 197, 94, 0.95);
  font-weight: 700;
  flex-shrink: 0;
}

.selected-indicator {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(34, 197, 94, 0.3);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 12px;
  font-weight: bold;
}

/* Personality Guide - Background Layer */
.personality-guide {
  position: fixed;
  top: 120px;
  left: 24px;
  z-index: 1;
  background: rgba(255, 255, 255, 0.04);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.07);
  border-radius: 16px;
  padding: 14px 16px;
  max-width: 160px;
  pointer-events: none;
}

.guide-title {
  color: rgba(255, 255, 255, 0.4);
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.8px;
  text-transform: uppercase;
  margin-bottom: 10px;
}

.guide-grid {
  display: flex;
  flex-direction: column;
  gap: 7px;
}

.guide-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.guide-icon {
  font-size: 14px;
  line-height: 1;
  opacity: 0.7;
}

.guide-name {
  color: rgba(255, 255, 255, 0.35);
  font-size: 11px;
  font-weight: 500;
}

/* Hide guide on small screens to avoid clutter */
@media (max-width: 900px) {
  .personality-guide {
    display: none;
  }
}

/* ===== CART PILL + PANEL ===== */
.cart-pill-wrap {
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 300;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.cart-pill {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 13px 26px;
  background: linear-gradient(135deg, rgba(34,197,94,0.16) 0%, rgba(52,211,153,0.12) 100%);
  backdrop-filter: blur(32px) saturate(180%);
  -webkit-backdrop-filter: blur(32px) saturate(180%);
  border: 1px solid rgba(34,197,94,0.28);
  border-top: 1px solid rgba(34,197,94,0.4);
  border-radius: 50px;
  color: white;
  font-size: 14px;
  font-weight: 700;
  letter-spacing: -0.2px;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.22,1,0.36,1);
  box-shadow: 0 6px 28px rgba(0,0,0,0.4), 0 0 0 1px rgba(34,197,94,0.1) inset;
  white-space: nowrap;
}

.cart-pill:hover {
  background: linear-gradient(135deg, rgba(34,197,94,0.24) 0%, rgba(52,211,153,0.18) 100%);
  border-color: rgba(34,197,94,0.4);
  transform: translateY(-3px);
  box-shadow: 0 10px 36px rgba(0,0,0,0.5), 0 0 20px rgba(34,197,94,0.12);
}

.cart-pill-icon { font-size: 16px; }
.cart-pill-count { flex: 1; }
.cart-pill-arrow { font-size: 9px; opacity: 0.6; }

/* Expanded cart panel above the pill */
.cart-panel {
  width: 360px;
  max-width: calc(100vw - 32px);
  background: linear-gradient(160deg, rgba(10,20,8,0.75) 0%, rgba(6,14,6,0.70) 100%);
  backdrop-filter: blur(52px) saturate(200%);
  -webkit-backdrop-filter: blur(52px) saturate(200%);
  border: 1px solid rgba(255,255,255,0.12);
  border-top: 1px solid rgba(255,255,255,0.22);
  border-left: 1px solid rgba(255,255,255,0.16);
  border-radius: 22px;
  padding: 18px 16px 16px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.1);
  animation: slideUp 0.18s cubic-bezier(0.22,1,0.36,1);
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(16px) scale(0.97); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}

.cart-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 14px;
}

.cart-panel-title-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.cart-panel-icon { font-size: 18px; }

.cart-panel-title {
  color: white;
  font-size: 15px;
  font-weight: 700;
  letter-spacing: -0.2px;
}

.cart-panel-count {
  background: rgba(167,139,250,0.25);
  border: 1px solid rgba(167,139,250,0.35);
  color: #c4b5fd;
  font-size: 11px;
  font-weight: 700;
  border-radius: 20px;
  padding: 1px 7px;
  line-height: 1.5;
}

.cart-panel-close {
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.1);
  color: rgba(255,255,255,0.5);
  font-size: 12px;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 8px;
  transition: all 0.15s;
  line-height: 1;
}

.cart-panel-close:hover { background: rgba(255,255,255,0.12); color: white; }

.cart-panel-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
  max-height: 200px;
  overflow-y: auto;
  margin-bottom: 14px;
  scrollbar-width: none;
}

.cart-panel-grid::-webkit-scrollbar { display: none; }

.cart-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 8px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  position: relative;
  transition: all 0.15s;
}

.cart-card:hover {
  background: rgba(255,255,255,0.08);
  transform: translateY(-1px);
}

.cart-card-icon {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  margin-bottom: 4px;
  background: rgba(255,255,255,0.1);
}

.cart-card-icon.gender-female {
  background: linear-gradient(135deg, #ff6b9d, #c66cfd);
}

.cart-card-icon.gender-male {
  background: linear-gradient(135deg, #4facfe, #00f2fe);
}

.cart-card-name {
  font-size: 10px;
  color: white;
  text-align: center;
  font-weight: 500;
  line-height: 1.2;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.cart-card-remove {
  position: absolute;
  top: 2px;
  right: 2px;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: rgba(239,68,68,0.8);
  border: none;
  color: white;
  font-size: 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: all 0.15s;
}

.cart-card:hover .cart-card-remove {
  opacity: 1;
}

.cart-card-remove:hover {
  background: rgba(239,68,68,1);
  transform: scale(1.1);
}

.cart-panel-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-height: 280px;
  overflow-y: auto;
  scrollbar-width: none;
  margin-bottom: 14px;
}
.cart-panel-list::-webkit-scrollbar { display: none; }

.offer-type-buttons {
  display: flex;
  gap: 6px;
  margin-bottom: 12px;
  background: rgba(0,0,0,0.2);
  padding: 4px;
  border-radius: 12px;
}

.offer-type-btn {
  flex: 1;
  padding: 8px 12px;
  border: 1px solid transparent;
  background: transparent;
  color: rgba(255,255,255,0.5);
  border-radius: 8px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

.offer-type-btn:hover {
  background: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.8);
}

.offer-type-btn.active {
  background: linear-gradient(135deg, rgba(167,139,250,0.4) 0%, rgba(52,211,153,0.3) 100%);
  border-color: rgba(167,139,250,0.3);
  color: white;
  box-shadow: 0 2px 8px rgba(167,139,250,0.2);
}

.checkout-amount-input {
  width: 100%;
  padding: 10px 14px;
  border: 1px solid rgba(255,255,255,0.15);
  background: linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.04) 100%);
  color: white;
  border-radius: 10px;
  font-size: 14px;
  margin-bottom: 8px;
  transition: all 0.2s ease;
  font-weight: 500;
}

.checkout-amount-input:focus {
  outline: none;
  border-color: rgba(167,139,250,0.6);
  background: linear-gradient(145deg, rgba(255,255,255,0.12) 0%, rgba(255,255,255,0.06) 100%);
  box-shadow: 0 0 0 3px rgba(167,139,250,0.1);
}

.checkout-amount-input::placeholder {
  color: rgba(255,255,255,0.5);
}

.no-offer-message {
  padding: 10px 14px;
  background: linear-gradient(145deg, rgba(52,211,153,0.1) 0%, rgba(34,197,94,0.08) 100%);
  border: 1px solid rgba(52,211,153,0.2);
  border-radius: 10px;
  text-align: center;
  color: rgba(52,211,153,0.9);
  font-size: 14px;
  font-weight: 500;
}

.checkout-checkbox {
  margin: 20px 28px 16px;
  display: flex;
  justify-content: center;
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: 12px;
  color: rgba(255,255,255,0.9);
  font-size: 14px;
  cursor: pointer;
  user-select: none;
  font-weight: 500;
  padding: 12px 16px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 12px;
  transition: all 0.2s ease;
  width: 100%;
  max-width: 400px;
  justify-content: center;
}

.checkbox-label:hover {
  background: rgba(255,255,255,0.08);
  border-color: rgba(255,255,255,0.12);
}

.checkbox-label input[type="checkbox"] {
  width: 18px;
  height: 18px;
  accent-color: #a78aff;
  cursor: pointer;
  margin: 0;
}

.cart-item-row {
  display: flex;
  align-items: center;
  gap: 10px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 12px;
  padding: 8px 10px;
  transition: background 0.12s;
}
.cart-item-row:hover { background: rgba(255,255,255,0.08); }

.cart-item-avatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  flex-shrink: 0;
}

.cart-item-info {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.cart-item-name {
  color: white;
  font-size: 13px;
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.cart-item-species {
  color: rgba(255,255,255,0.35);
  font-size: 10px;
}

.cart-item-remove {
  background: none;
  border: none;
  color: rgba(255,255,255,0.25);
  font-size: 11px;
  cursor: pointer;
  padding: 4px 6px;
  border-radius: 6px;
  transition: all 0.12s;
  flex-shrink: 0;
}
.cart-item-remove:hover { color: #f87171; background: rgba(239,68,68,0.12); }

.cart-request-btn {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: linear-gradient(135deg, rgba(167,139,250,0.22) 0%, rgba(52,211,153,0.18) 100%);
  border: 1px solid rgba(167,139,250,0.35);
  border-radius: 14px;
  padding: 12px 16px;
  color: white;
  font-weight: 700;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  letter-spacing: -0.1px;
}
.cart-request-btn:hover { background: linear-gradient(135deg, rgba(167,139,250,0.32) 0%, rgba(52,211,153,0.28) 100%); transform: translateY(-1px); box-shadow: 0 6px 20px rgba(0,0,0,0.3); }
.cart-request-arrow { font-size: 18px; opacity: 0.8; }

.request-btn {
  width: calc(100% - 56px);
  background: linear-gradient(135deg, rgba(167,139,250,0.4) 0%, rgba(52,211,153,0.3) 100%);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(167,139,250,0.3);
  color: white;
  padding: 14px 28px;
  border-radius: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 15px;
  margin: 0 28px 28px;
  box-shadow: 0 4px 20px rgba(167,139,250,0.2);
  position: relative;
  overflow: hidden;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.request-btn:hover:not(:disabled) {
  background: linear-gradient(135deg, rgba(167,139,250,0.5) 0%, rgba(52,211,153,0.4) 100%);
  transform: translateY(-2px);
  box-shadow: 0 6px 30px rgba(167,139,250,0.3);
  border-color: rgba(167,139,250,0.4);
}

.request-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

/* Layout Utilities */
.fixed {
  position: fixed;
}

.top-6 {
  top: 24px;
}

.left-1\/2 {
  left: 50%;
}

.transform {
  transform: translate(-50%, -50%);
}

.z-50 {
  z-index: 50;
}

.flex {
  display: flex;
}

.items-center {
  align-items: center;
}

.space-x-6 > * + * {
  margin-left: 24px;
}

.pt-24 {
  padding-top: 96px;
}

.px-6 {
  padding-left: 24px;
  padding-right: 24px;
}

.pb-6 {
  padding-bottom: 24px;
}

.max-w-2xl {
  max-width: 672px;
}

.max-w-4xl {
  max-width: 896px;
}

.max-w-7xl {
  max-width: 1280px;
}

.mx-auto {
  margin-left: auto;
  margin-right: auto;
}

.mb-8 {
  margin-bottom: 32px;
}

.mb-12 {
  margin-bottom: 48px;
}

.mb-16 {
  margin-bottom: 64px;
}

.mt-8 {
  margin-top: 32px;
}

.gap-16 {
  gap: 64px;
}

.gap-24 {
  gap: 96px;
}

.bottom-6 {
  bottom: 24px;
}

.right-6 {
  right: 24px;
}

.w-full {
  width: 100%;
}

.bg-transparent {
  background: transparent;
}

.text-white {
  color: white;
}

.outline-none {
  outline: none;
}

.justify-center {
  justify-content: center;
}

.flex-wrap {
  flex-wrap: wrap;
}

/* Scrollbar Styling */
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.3);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.5);
}

/* Responsive */
@media (min-width: 768px) {
  .villager-grid {
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  }
}

@media (min-width: 1024px) {
  .villager-grid {
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  }
}

/* ===== APP LAYOUT ===== */
.app-bg {
  background: linear-gradient(160deg, #0f1108 0%, #181a06 40%, #12140a 100%);
  min-height: 100vh;
  position: relative;
}

.app-bg-overlay {
  position: fixed;
  inset: 0;
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  opacity: 0.04;
  pointer-events: none;
  z-index: 1;
}

.app-bg > *:not(.app-bg-overlay) {
  position: relative;
  z-index: 2;
}

.app-layout {
  display: flex;
  min-height: 100vh;
}

.main-content {
  flex: 1;
  padding: 24px;
  transition: margin-left 0.3s ease;
  min-width: 0;
}

.main-content.with-sidebar {
  margin-left: 302px;
}

/* ===== SIDEBAR ===== */
.sidebar {
  position: fixed;
  top: 16px;
  left: 16px;
  bottom: 16px;
  z-index: 200;
  transition: width 0.3s ease;
  display: flex;
  flex-direction: column;
  border-radius: 20px;
  /* No overflow:hidden here — lets toggle button sit outside without clipping */
}

.sidebar.open {
  width: 270px;
}

.sidebar.closed {
  width: 0;
  pointer-events: none;
}

/* ===== SIDEBAR LOGO HEADER ===== */
.sidebar-logo-header {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 12px 16px 14px;
  border-bottom: 1px solid rgba(255,255,255,0.07);
  margin-bottom: 4px;
  flex-shrink: 0;
}

.sidebar-logo-img {
  width: 140px;
  height: auto;
  object-fit: contain;
  opacity: 0.92;
  filter: drop-shadow(0 2px 8px rgba(0,0,0,0.4));
}

/* Shell: full height flex column, clips to rounded corners, backdrop here */
.sidebar-shell {
  display: flex;
  flex-direction: column;
  height: 100%;
  background: linear-gradient(170deg, rgba(10,20,8,0.75) 0%, rgba(6,13,5,0.72) 100%);
  backdrop-filter: blur(52px) saturate(200%);
  -webkit-backdrop-filter: blur(52px) saturate(200%);
  border: 1px solid rgba(255,255,255,0.08);
  border-top: 1px solid rgba(255,255,255,0.16);
  border-left: 1px solid rgba(255,255,255,0.12);
  border-radius: 22px;
  box-shadow: 0 16px 64px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.07);
  overflow: hidden;
}

/* Scrollable content area */
.sidebar-inner {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow-y: auto;
  padding: 20px 14px 8px;
  gap: 0;
  scrollbar-width: none;
  min-height: 0;
}

.sidebar-inner::-webkit-scrollbar {
  display: none;
}

.sidebar-toggle {
  position: fixed;
  top: 50%;
  left: 0;
  transform: translateY(-50%);
  width: 28px;
  height: 48px;
  background: rgba(20, 28, 8, 0.85);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-left: none;
  border-radius: 0 10px 10px 0;
  color: rgba(255,255,255,0.6);
  cursor: pointer;
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 201;
  pointer-events: all;
  transition: background 0.2s, left 0.3s ease;
  box-shadow: 2px 0 12px rgba(0,0,0,0.25);
}

.sidebar.open .sidebar-toggle {
  left: calc(16px + 270px - 1px);
  border-left: 1px solid rgba(255,255,255,0.12);
  border-radius: 0 10px 10px 0;
}

.sidebar-toggle:hover {
  background: rgba(255, 255, 255, 0.15);
  color: white;
}

/* Sidebar Search */
.sidebar-search-wrap {
  position: relative;
  padding-bottom: 14px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.07);
  margin-bottom: 2px;
}

.sidebar-search-bare {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 2px;
}

.search-icon-inline {
  font-size: 14px;
  opacity: 0.7;
  flex-shrink: 0;
}

.search-clear {
  background: none;
  border: none;
  color: rgba(255,255,255,0.5);
  cursor: pointer;
  font-size: 11px;
  padding: 0;
  flex-shrink: 0;
}

.search-clear:hover {
  color: white;
}

.sidebar-search-dropdown {
  position: absolute;
  top: calc(100% + 6px);
  left: 0;
  right: 0;
  background: rgba(20, 10, 50, 0.85);
  backdrop-filter: blur(30px);
  -webkit-backdrop-filter: blur(30px);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 14px;
  overflow: hidden;
  z-index: 300;
  box-shadow: 0 12px 40px rgba(0,0,0,0.4);
}

.search-result-icon-wrap {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  flex-shrink: 0;
}

/* Sidebar sections */
.sidebar-section {
  padding: 14px 0 12px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);
}

.sidebar-section-label {
  font-size: 9.5px;
  font-weight: 700;
  letter-spacing: 0.9px;
  text-transform: uppercase;
  color: rgba(255, 255, 255, 0.28);
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.inline-clear {
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.3);
  font-size: 9px;
  cursor: pointer;
  padding: 0;
  text-transform: lowercase;
  letter-spacing: 0;
  font-weight: 400;
  transition: color 0.15s;
}

.inline-clear:hover {
  color: rgba(255, 255, 255, 0.7);
}

.inline-filter-row {
  display: flex;
  gap: 6px;
}

.inline-filter-row.wrap {
  flex-wrap: wrap;
}

.inline-filter-chip {
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.45);
  font-size: 11px;
  padding: 4px 2px;
  cursor: pointer;
  border-radius: 4px;
  transition: color 0.15s, background 0.15s;
  white-space: nowrap;
}

.inline-filter-chip:hover {
  color: rgba(255, 255, 255, 0.85);
  background: rgba(255, 255, 255, 0.06);
}

.inline-filter-chip.active {
  color: white;
  font-weight: 600;
}

/* Guide grid inside sidebar */
.guide-grid-sidebar {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 5px;
}

/* Species letter-grouped list */
.species-letter-list {
  display: flex;
  flex-direction: column;
  gap: 3px;
}

.species-letter-row {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  line-height: 1.6;
}

.species-sep {
  color: rgba(255, 255, 255, 0.35);
  font-size: 11px;
  pointer-events: none;
  user-select: none;
  padding: 0 5px;
  flex-shrink: 0;
}

.species-chip {
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.45);
  font-size: 11px;
  padding: 1px 0;
  cursor: pointer;
  transition: color 0.12s;
  white-space: nowrap;
}

.species-chip:hover {
  color: rgba(255, 255, 255, 0.85);
}

.species-chip.active {
  color: white;
  font-weight: 600;
}

/* Sidebar Nav — always at bottom, never scrolls, no background (shell handles it) */
.sidebar-nav {
  flex-shrink: 0;
  padding: 10px 14px 14px;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
  background: none;
  display: flex;
  flex-direction: row;
  justify-content: space-around;
  gap: 0;
}

.sidebar-nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  padding: 7px 8px;
  border-radius: 12px;
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.4);
  cursor: pointer;
  transition: all 0.18s cubic-bezier(0.22,1,0.36,1);
  flex: 1;
  min-width: 0;
}

.nav-item-icon {
  font-size: 18px;
  line-height: 1;
  filter: grayscale(1) brightness(10);
}

.nav-item-label {
  font-size: 9px;
  font-weight: 500;
  letter-spacing: 0.2px;
  opacity: 0;
  transition: opacity 0.15s;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.sidebar-nav-item:hover .nav-item-label,
.sidebar-nav-item.active .nav-item-label {
  opacity: 1;
}

.sidebar-nav-item:hover {
  color: white;
}

.sidebar-nav-item.active {
  color: white;
  background: rgba(255,255,255,0.07);
}

/* ===== VILLAGER CARD EXPANDED + ACTIONS ===== */
.villager-tile {
  position: relative;
}

.villager-tile.expanded {
  background: rgba(255, 255, 255, 0.13);
}

.cart-glow-border {
  position: absolute;
  inset: 0;
  border-radius: 16px;
  border: 2px solid rgba(34, 197, 94, 0.5);
  box-shadow: 0 0 20px rgba(34, 197, 94, 0.2), inset 0 0 20px rgba(34, 197, 94, 0.05);
  pointer-events: none;
}

/* ===== POPULARITY BORDERS ===== */
.pop-border {
  position: absolute;
  inset: 0;
  border-radius: 16px;
  pointer-events: none;
  z-index: 1;
}

/* Popularity borders removed */

/* ===== LETTER-PAGINATED SWIPE VIEW ===== */
.letter-page-wrap {
  display: flex;
  align-items: flex-start;
  gap: 0;
  position: relative;
}

.letter-nav-btn {
  flex-shrink: 0;
  width: 44px;
  height: 44px;
  align-self: center;
  position: sticky;
  top: calc(50vh - 22px);
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 50%;
  color: rgba(255,255,255,0.7);
  font-size: 30px;
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.18s cubic-bezier(0.22,1,0.36,1);
  z-index: 10;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

.letter-nav-btn:hover {
  background: rgba(255,255,255,0.13);
  border-color: rgba(255,255,255,0.22);
  color: white;
  transform: scale(1.1);
}

.letter-nav-btn.hidden {
  opacity: 0;
  pointer-events: none;
}

.letter-page-slider {
  flex: 1;
  min-width: 0;
  animation: slidePageIn 0.22s cubic-bezier(0.22,1,0.36,1) both;
}

.letter-page-slider.slide-out-left {
  animation: slidePageFromRight 0.22s cubic-bezier(0.22,1,0.36,1) both;
}

.letter-page-slider.slide-out-right {
  animation: slidePageFromLeft 0.22s cubic-bezier(0.22,1,0.36,1) both;
}

@keyframes slidePageIn {
  from { opacity: 0.6; transform: translateX(0); }
  to   { opacity: 1;   transform: translateX(0); }
}

@keyframes slidePageFromRight {
  from { opacity: 0; transform: translateX(32px); }
  to   { opacity: 1; transform: translateX(0); }
}

@keyframes slidePageFromLeft {
  from { opacity: 0; transform: translateX(-32px); }
  to   { opacity: 1; transform: translateX(0); }
}

.letter-page-heading {
  display: flex;
  align-items: baseline;
  gap: 12px;
  margin-bottom: 20px;
  padding: 0 4px;
}

.letter-page-letter {
  font-size: 52px;
  font-weight: 900;
  color: rgba(255,255,255,0.07);
  line-height: 1;
  letter-spacing: -2px;
  user-select: none;
}

.letter-page-count {
  font-size: 12px;
  font-weight: 600;
  color: rgba(255,255,255,0.28);
}

.letter-page-dots {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 3px;
  padding: 18px 8px 4px;
}

.letter-dot {
  background: none;
  border: none;
  padding: 2px 1px;
  cursor: pointer;
  transition: all 0.15s;
}

.letter-dot-label {
  display: block;
  font-size: 11px;
  font-weight: 700;
  color: rgba(255,255,255,0.2);
  transition: color 0.15s;
  min-width: 14px;
  text-align: center;
}

.letter-dot:hover .letter-dot-label {
  color: rgba(255,255,255,0.6);
}

.letter-dot.active .letter-dot-label {
  color: rgba(255,255,255,0.95);
}

/* Mobile: hide arrows entirely — swipe only */
@media (max-width: 768px) {
  .letter-nav-btn {
    display: none;
  }
  .letter-page-letter {
    font-size: 36px;
  }
}

/* ===== RECOMMENDED STRIP ===== */
.rec-strip {
  margin: 0 0 28px 0;
  padding: 20px 24px;
  background: linear-gradient(135deg, rgba(167,139,250,0.06) 0%, rgba(251,191,36,0.06) 100%);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 20px;
  position: relative;
  overflow: hidden;
}
.rec-strip::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 20px;
  background: linear-gradient(135deg, rgba(167,139,250,0.03), rgba(251,191,36,0.03));
  pointer-events: none;
}

.rec-strip-header {
  display: flex;
  align-items: baseline;
  gap: 10px;
  margin-bottom: 16px;
}
.rec-strip-title {
  font-size: 15px;
  font-weight: 800;
  color: white;
  letter-spacing: 0.2px;
}
.rec-strip-sub {
  font-size: 12px;
  color: rgba(255,255,255,0.35);
}

/* ===== PODIUM STAGE ===== */
.podium-stage {
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 12px;
  padding-bottom: 0;
}

/* Each slot = card stacked on top of its plinth */
.podium-slot {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 1;
  max-width: 200px;
  min-width: 0;
  transition: flex 0.25s cubic-bezier(0.22,1,0.36,1);
}

/* Expand the slot when its card is open */
.podium-slot.expanded {
  flex: 2.5;
  max-width: 420px;
}

/* The card itself */
.podium-card {
  position: relative;
  width: 100%;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 18px;
  padding: 14px 12px 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  transition: transform 0.15s, background 0.15s, box-shadow 0.15s;
  box-sizing: border-box;
}
.podium-card:hover {
  transform: translateY(-3px);
  background: rgba(255,255,255,0.08);
  box-shadow: 0 8px 24px rgba(0,0,0,0.3);
}

/* Gold/1st card gets a subtle glow */
.podium-first .podium-card {
  border-color: rgba(251,191,36,0.3);
  background: rgba(251,191,36,0.07);
}
.podium-first .podium-card:hover {
  background: rgba(251,191,36,0.11);
}

/* Rank medal badge */
.podium-rank-badge {
  font-size: 20px;
  line-height: 1;
  margin-bottom: 2px;
}

/* Icon wrapper — same sizing as main grid */
.podium-card-icon {
  width: 52px;
  height: 52px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
  flex-shrink: 0;
}

.podium-card-name {
  font-size: 13px;
  font-weight: 800;
  color: white;
  text-align: center;
  letter-spacing: -0.2px;
}

/* Keep label styles */
.rec-label {
  font-size: 10px;
  font-weight: 600;
  border-radius: 6px;
  padding: 2px 7px;
  text-align: center;
}
.rec-label.requested {
  background: rgba(167,139,250,0.15);
  color: #a78bfa;
  border: 1px solid rgba(167,139,250,0.25);
}
.rec-label.traded {
  background: rgba(34,197,94,0.12);
  color: #4ade80;
  border: 1px solid rgba(34,197,94,0.2);
}

/* Expanded detail panel inside podium card — full width, no overflow */
.podium-card-expanded {
  width: 100%;
  box-sizing: border-box;
  margin-top: 4px;
}

/* Expanded panel outside the card (between card and plinth) */
.podium-card-expanded-panel {
  width: 100%;
  box-sizing: border-box;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 14px;
  padding: 10px 12px 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

/* Inside the expanded panel: reset card-top-actions to normal flow */
.podium-card-expanded-panel .card-top-actions {
  position: static;
  opacity: 1;
  display: flex;
  justify-content: center;
  gap: 4px;
  padding: 0;
  margin-bottom: 8px;
}

/* The plinth below the card */
.podium-plinth {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 0 0 12px 12px;
  font-weight: 900;
  font-size: 18px;
  color: rgba(255,255,255,0.5);
  flex-shrink: 0;
}

.podium-first .podium-plinth {
  background: linear-gradient(180deg, rgba(251,191,36,0.25) 0%, rgba(251,191,36,0.1) 100%);
  border: 1px solid rgba(251,191,36,0.2);
  border-top: none;
  height: 52px;
  color: rgba(251,191,36,0.8);
}
.podium-second .podium-plinth {
  background: linear-gradient(180deg, rgba(203,213,225,0.18) 0%, rgba(203,213,225,0.07) 100%);
  border: 1px solid rgba(203,213,225,0.15);
  border-top: none;
  height: 38px;
  color: rgba(203,213,225,0.7);
}
.podium-third .podium-plinth {
  background: linear-gradient(180deg, rgba(180,120,60,0.18) 0%, rgba(180,120,60,0.07) 100%);
  border: 1px solid rgba(180,120,60,0.15);
  border-top: none;
  height: 28px;
  color: rgba(180,120,60,0.7);
}

.podium-plinth-num {
  font-size: 14px;
  font-weight: 800;
  letter-spacing: -0.3px;
}

/* Mobile: tighter */
@media (max-width: 600px) {
  .podium-stage { gap: 8px; }
  .podium-card { padding: 10px 8px 8px; border-radius: 14px; }
  .podium-card-icon { width: 40px; height: 40px; font-size: 20px; }
  .podium-card-name { font-size: 11px; }
  .podium-rank-badge { font-size: 16px; }
}

/* card-top-actions inside podium: compact */
.podium-card .card-top-actions {
  flex-wrap: wrap;
  justify-content: center;
}

.rec-card-actions {
  display: flex;
  gap: 3px;
  margin-top: 2px;
}
.rec-card-actions .card-top-btn {
  width: 24px;
  height: 24px;
  font-size: 11px;
  border-radius: 6px;
}

.cart-remove-btn {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: rgba(239, 68, 68, 0.25);
  border: 1px solid rgba(239, 68, 68, 0.4);
  color: rgba(255,255,255,0.85);
  font-size: 11px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: background 0.2s;
  padding: 0;
}

.cart-remove-btn:hover {
  background: rgba(239, 68, 68, 0.5);
}

.card-expanded {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.card-detail-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 0;
  font-size: 12px;
}

.card-detail-label {
  color: rgba(255, 255, 255, 0.45);
  font-weight: 500;
}

.card-detail-value {
  color: rgba(255, 255, 255, 0.85);
  font-weight: 600;
}

.card-popularity {
  color: rgba(255, 255, 255, 0.4);
  font-style: italic;
}

/* Bottom action bar on each card */
.card-top-actions {
  position: absolute;
  bottom: 4px;
  left: 0;
  right: 0;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-around;
  gap: 0;
  opacity: 0;
  transition: opacity 0.15s cubic-bezier(0.22,1,0.36,1);
  z-index: 2;
  padding: 4px 2px;
}

/* Always show active buttons */
.card-top-actions:has(.card-top-btn.owned-active),
.card-top-actions:has(.card-top-btn.fav-active),
.card-top-actions:has(.card-top-btn.wish-active),
.card-top-actions:has(.card-top-btn.in-cart) {
  opacity: 1;
}

.villager-tile:hover .card-top-actions {
  opacity: 1;
}

.card-top-btn {
  background: none;
  border: none;
  padding: 5px 6px;
  font-size: 14px;
  cursor: pointer;
  line-height: 1;
  color: rgba(255, 255, 255, 0.28);
  filter: grayscale(1) opacity(0.3);
  transition: color 0.12s, filter 0.12s, transform 0.12s cubic-bezier(0.22,1,0.36,1);
  font-family: inherit;
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
}

.card-top-btn:hover {
  transform: scale(1.25);
  background: rgba(255,255,255,0.06);
  filter: grayscale(0) opacity(0.7);
}

/* Owned: green checkmark */
.owned-btn { color: rgba(255,255,255,0.2); }
.owned-btn:hover { color: rgba(34, 197, 94, 0.85); filter: grayscale(0) opacity(0.85); }
.owned-btn.owned-active { color: #22c55e; filter: grayscale(0) opacity(1); }

/* Favourite: red heart */
.fav-btn { color: rgba(255,255,255,0.2); }
.fav-btn:hover { color: rgba(239, 68, 68, 0.85); filter: grayscale(0) opacity(0.85); }
.fav-btn.fav-active { color: #ef4444; filter: grayscale(0) opacity(1); }

/* Wishlist: star — uses filter so emoji is visibly dim/bright on iOS */
.wish-btn { color: rgba(255,255,255,0.2); }
.wish-btn:hover { color: rgba(251, 191, 36, 0.85); filter: grayscale(0) opacity(0.85); }
.wish-btn.wish-active { color: #fbbf24; filter: grayscale(0) opacity(1); }

/* Cart arrow */
.cart-arrow-btn {
  color: rgba(255,255,255,0.25);
  font-size: 14px;
  font-weight: 700;
}

.cart-arrow-btn:hover {
  color: white;
}

.cart-arrow-btn.in-cart {
  color: rgba(239, 68, 68, 0.9);
}

/* Corner action buttons — borderless floating icons */
.corner-actions {
  position: absolute;
  bottom: 7px;
  right: 7px;
  display: flex;
  gap: 1px;
  opacity: 0;
  transition: opacity 0.15s ease;
}

/* Always show active states even when not hovering */
.corner-actions:has(.corner-btn.owned-active),
.corner-actions:has(.corner-btn.fav-active),
.corner-actions:has(.corner-btn.wish-active) {
  opacity: 1;
}

.villager-tile:hover .corner-actions {
  opacity: 1;
}

.corner-btn {
  background: none;
  border: none;
  padding: 1px 2px;
  font-size: 12px;
  cursor: pointer;
  line-height: 1;
  opacity: 0.3;
  transition: opacity 0.15s, transform 0.15s;
  filter: grayscale(1);
}

.corner-btn:hover {
  opacity: 1;
  transform: scale(1.25);
  filter: none;
}

.corner-btn.owned-active,
.corner-btn.fav-active,
.corner-btn.wish-active {
  opacity: 1;
  filter: none;
}

/* Fixed back arrow for login/profile pages */
.page-back-btn {
  position: fixed;
  top: 20px;
  left: 20px;
  background: rgba(255,255,255,0.07);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 50px;
  color: rgba(255, 255, 255, 0.7);
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  z-index: 100;
  padding: 8px 16px;
  transition: all 0.18s cubic-bezier(0.22,1,0.36,1);
  line-height: 1;
  letter-spacing: -0.1px;
}

.page-back-btn:hover {
  background: rgba(255,255,255,0.12);
  color: white;
  border-color: rgba(255,255,255,0.2);
  transform: translateX(-2px);
}

/* ===== LOGIN PAGE ===== */
.login-screen {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
}

/* User number display during signup */
.user-number-display {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  background: rgba(255, 255, 255, 0.06);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 14px;
  padding: 16px 24px;
  margin-bottom: 16px;
  text-align: center;
}

.user-number-label {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.8px;
  text-transform: uppercase;
  color: rgba(255,255,255,0.45);
}

.user-number-value {
  font-size: 32px;
  font-weight: 800;
  color: white;
  letter-spacing: 1px;
}

.user-number-hint {
  font-size: 11px;
  color: rgba(255,255,255,0.4);
  margin-top: 2px;
}

.login-glass {
  background: linear-gradient(160deg, rgba(15,28,12,0.85) 0%, rgba(10,18,8,0.82) 100%);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.10);
  border-top: 1px solid rgba(255,255,255,0.18);
  border-radius: 28px;
  padding: 44px 40px;
  width: 100%;
  max-width: 420px;
  box-shadow: 0 32px 80px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.08);
}

.login-glass.owned-selector {
  max-width: 90vw;
  max-height: 90vh;
  overflow-y: auto;
  padding: 28px;
}

.login-logo {
  font-size: 48px;
  text-align: center;
  margin-bottom: 12px;
}

.login-title {
  color: white;
  font-size: 24px;
  font-weight: 700;
  text-align: center;
  margin: 0 0 8px 0;
}

.login-sub {
  color: rgba(255, 255, 255, 0.55);
  font-size: 14px;
  text-align: center;
  margin: 0 0 28px 0;
}

.login-actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.login-form {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 20px;
}

.login-input {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.18);
  border-radius: 12px;
  padding: 12px 16px;
  color: white;
  font-size: 15px;
  outline: none;
  transition: border-color 0.2s;
  width: 100%;
}

.login-input::placeholder {
  color: rgba(255, 255, 255, 0.4);
}

.login-input:focus {
  border-color: rgba(255, 255, 255, 0.4);
  background: rgba(255, 255, 255, 0.14);
}

.login-error {
  background: rgba(239, 68, 68, 0.15);
  border: 1px solid rgba(239, 68, 68, 0.3);
  border-radius: 10px;
  padding: 10px 14px;
  color: rgba(255, 180, 180, 0.95);
  font-size: 13px;
}

.login-footer {
  color: rgba(255, 255, 255, 0.45);
  font-size: 13px;
  text-align: center;
  margin: 0;
}

.back-btn {
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.55);
  font-size: 13px;
  cursor: pointer;
  padding: 0;
  margin-bottom: 20px;
  display: block;
  transition: color 0.2s;
}

.back-btn:hover {
  color: white;
}

.link-btn {
  background: none;
  border: none;
  color: rgba(167, 139, 250, 0.9);
  cursor: pointer;
  font-size: 13px;
  padding: 0;
  text-decoration: underline;
}

.secret-type-toggle {
  display: flex;
  gap: 8px;
}

.toggle-btn {
  flex: 1;
  padding: 10px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.07);
  border: 1px solid rgba(255, 255, 255, 0.12);
  color: rgba(255, 255, 255, 0.6);
  cursor: pointer;
  font-size: 13px;
  transition: all 0.2s;
}

.toggle-btn.active {
  background: rgba(167, 139, 250, 0.25);
  border-color: rgba(167, 139, 250, 0.5);
  color: white;
}

.btn-primary {
  background: rgba(167, 139, 250, 0.3);
  border: 1px solid rgba(167, 139, 250, 0.5);
  border-radius: 14px;
  padding: 14px 24px;
  color: white;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  width: 100%;
}

.btn-primary:hover {
  background: rgba(167, 139, 250, 0.45);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(167, 139, 250, 0.3);
}

.btn-primary.big {
  padding: 16px 24px;
  font-size: 16px;
}

.btn-primary:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.btn-ghost {
  background: rgba(255, 255, 255, 0.06);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 14px;
  padding: 12px 24px;
  color: rgba(255, 255, 255, 0.7);
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  width: 100%;
}

.btn-ghost:hover {
  background: rgba(255, 255, 255, 0.1);
  color: white;
}

.btn-ghost.small {
  width: auto;
  padding: 8px 14px;
  font-size: 12px;
}

.btn-secondary {
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 12px;
  padding: 12px 20px;
  color: rgba(255,255,255,0.8);
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-secondary:hover {
  background: rgba(255,255,255,0.14);
}

/* Owned selector grid */
.owned-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  margin: 20px 0;
  max-height: 60vh;
  overflow-y: auto;
}

.owned-tile {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 8px 4px;
  border-radius: 10px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.08);
  cursor: pointer;
  transition: all 0.2s;
  color: white;
}

.owned-tile:hover {
  background: rgba(255,255,255,0.12);
}

.owned-tile.selected {
  background: rgba(34, 197, 94, 0.18);
  border-color: rgba(34, 197, 94, 0.4);
}

.owned-tile.gender-female {
  border-color: rgba(255, 80, 140, 0.2);
}

.owned-tile.gender-female.selected {
  background: rgba(255, 80, 140, 0.18);
  border-color: rgba(255, 80, 140, 0.4);
}

.owned-tile.gender-male.selected {
  background: rgba(60, 130, 255, 0.18);
  border-color: rgba(60, 130, 255, 0.4);
}

.owned-icon {
  font-size: 20px;
}

.owned-name {
  font-size: 9px;
  color: rgba(255,255,255,0.7);
  text-align: center;
  line-height: 1.2;
  word-break: break-word;
}

.owned-check {
  position: absolute;
  top: 3px;
  right: 5px;
  font-size: 9px;
  color: rgba(34, 197, 94, 0.9);
  font-weight: 700;
}

.owned-tile.gender-female .owned-check {
  color: rgba(255, 80, 140, 0.9);
}

.owned-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

/* ===== PROFILE PAGE (new pro-* classes) ===== */
.profile-page {
  min-height: 100vh;
  padding: 72px 28px 60px 310px;
  max-width: 1200px;
}
.profile-page.profile-page--chat {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  height: 100vh;
  min-height: unset;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  padding: 16px 28px 16px 310px;
  max-width: 100%;
  box-sizing: border-box;
  z-index: 10;
  background: #0b130b;
}

/* Hero */
.pro-hero {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 20px;
  margin-bottom: 32px;
  padding: 24px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 24px;
}

.pro-hero-left {
  display: flex;
  align-items: center;
  gap: 16px;
  flex-shrink: 0;
}

.pro-avatar-ring {
  position: relative;
  width: 80px;
  height: 80px;
  cursor: pointer;
  flex-shrink: 0;
}

.pro-avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: rgba(120,80,220,0.25);
  border: 2px solid rgba(120,80,220,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  transition: border-color 0.2s;
}

.pro-avatar-ring:hover .pro-avatar { border-color: rgba(167,139,250,0.9); }

.pro-avatar-img { width:100%; height:100%; object-fit:cover; }
.pro-avatar-emoji {
  font-size: 38px;
  line-height: 1;
  filter: grayscale(1) brightness(0);
}
.pro-avatar-initials { color:white; font-size:28px; font-weight:700; }

.pro-avatar-edit-ring {
  position: absolute;
  bottom: 1px; right: 1px;
  width: 22px; height: 22px;
  background: rgba(0,0,0,0.7);
  border-radius: 50%;
  font-size: 11px;
  display: flex; align-items:center; justify-content:center;
  color: rgba(255,255,255,0.7);
  opacity: 0;
  transition: opacity 0.15s;
}

.pro-avatar-ring:hover .pro-avatar-edit-ring { opacity: 1; }

.pro-hero-text {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.pro-name {
  color: white;
  font-size: 24px;
  font-weight: 800;
  margin: 0 0 6px;
  letter-spacing: -0.3px;
}

.pro-id-chip {
  display: inline-block;
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 20px;
  color: rgba(255,255,255,0.45);
  font-size: 11px;
  padding: 2px 10px;
}

.pro-stats {
  display: flex;
  gap: 6px;
}

.pro-stat {
  flex: 1;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 10px 8px;
  text-align: center;
}

.pro-stat-num {
  display: block;
  font-size: 20px;
  font-weight: 700;
  line-height: 1;
  margin-bottom: 3px;
}

.pro-stat-label {
  color: rgba(255,255,255,0.4);
  font-size: 10px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.pro-hero-actions {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 8px;
  flex-shrink: 0;
}

.pro-push-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  background: none;
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 10px;
  color: rgba(255,255,255,0.35);
  font-size: 11px;
  padding: 7px 12px;
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}
.pro-push-btn.active {
  border-color: rgba(34,197,94,0.4);
  color: rgba(34,197,94,0.8);
}
.pro-push-btn:hover { opacity: 0.8; }
.pro-push-btn:disabled { opacity: 0.4; cursor: not-allowed; }

.pro-logout {
  background: none;
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 10px;
  color: rgba(255,255,255,0.35);
  font-size: 11px;
  padding: 7px 12px;
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}

.pro-logout:hover {
  border-color: rgba(239,68,68,0.5);
  color: rgba(239,68,68,0.7);
}

/* Inline username editor */
.pro-name-editable {
  cursor: pointer;
}
.pro-name-editable:hover .pro-name-edit-hint { opacity: 1; }
.pro-name-edit-hint {
  font-size: 14px;
  opacity: 0.3;
  transition: opacity 0.15s;
  vertical-align: middle;
}
.pro-username-edit {
  display: flex;
  align-items: center;
  gap: 6px;
}
.pro-username-input {
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(167,139,250,0.5);
  border-radius: 8px;
  color: white;
  font-size: 20px;
  font-weight: 700;
  padding: 3px 10px;
  outline: none;
  width: 180px;
}
.pro-username-save,
.pro-username-cancel {
  background: none;
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 6px;
  color: rgba(255,255,255,0.7);
  font-size: 14px;
  padding: 3px 8px;
  cursor: pointer;
}
.pro-username-save:hover { border-color: #4ade80; color: #4ade80; }
.pro-username-cancel:hover { border-color: #f87171; color: #f87171; }

/* Bio / Island name */
.pro-meta-col {
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-width: 180px;
  max-width: 260px;
}
.pro-meta-row {
  display: flex;
  align-items: flex-start;
  gap: 6px;
  opacity: 0.85;
  transition: opacity 0.15s;
}
.pro-meta-row:hover { opacity: 1; }
.pro-meta-icon { font-size: 13px; margin-top: 2px; flex-shrink: 0; }
.pro-meta-val { font-size: 12px; color: rgba(255,255,255,0.8); font-weight: 500; line-height: 1.4; }
.pro-meta-dim { font-size: 11px; color: rgba(255,255,255,0.4); font-weight: 400; }
.pro-meta-placeholder { font-size: 11px; color: rgba(255,255,255,0.3); font-style: italic; }
.pro-meta-edit-hint { color: rgba(255,255,255,0.3); font-size: 11px; }
.pro-meta-editable { cursor: pointer; }
.pro-meta-editable:hover .pro-meta-edit-hint { color: rgba(255,255,255,0.6); }
.pro-meta-edit-wrap { display: flex; align-items: flex-start; gap: 4px; flex-wrap: wrap; }
.pro-meta-input {
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 6px;
  padding: 3px 8px;
  color: white;
  font-size: 12px;
  outline: none;
  width: 160px;
}
.pro-meta-textarea {
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 6px;
  padding: 4px 8px;
  color: white;
  font-size: 12px;
  outline: none;
  width: 200px;
  resize: vertical;
}
.pro-meta-save, .pro-meta-cancel {
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 5px;
  color: white;
  font-size: 11px;
  padding: 3px 7px;
  cursor: pointer;
}
.pro-meta-save:hover { background: rgba(34,197,94,0.2); border-color: #22c55e; }
.pro-meta-cancel:hover { background: rgba(239,68,68,0.15); border-color: #f87171; }
.pro-meta-empty { font-size: 11px; color: rgba(255,255,255,0.3); font-style: italic; }
.pro-bio-display {
  margin-top: 7px;
  cursor: pointer;
  max-width: 280px;
}
.pro-bio-text {
  font-size: 12px;
  color: rgba(255,255,255,0.6);
  line-height: 1.5;
  display: block;
}
.pro-bio-edit-row {
  display: flex;
  align-items: flex-start;
  gap: 5px;
  margin-top: 5px;
  flex-wrap: wrap;
}
.pro-bio-input {
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(167,139,250,0.4);
  border-radius: 8px;
  color: white;
  font-size: 12px;
  padding: 4px 8px;
  outline: none;
  width: 180px;
}
.pro-bio-textarea {
  resize: none;
  font-family: inherit;
  line-height: 1.4;
  width: 200px;
}

/* In-app toast notifications */
.inapp-toast-container {
  position: fixed;
  top: 16px;
  right: 16px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 8px;
  pointer-events: none;
}
.inapp-toast {
  background: rgba(18,28,18,0.95);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 14px;
  padding: 12px 16px;
  display: flex;
  align-items: flex-start;
  gap: 10px;
  min-width: 240px;
  max-width: 320px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.5);
  backdrop-filter: blur(20px);
  pointer-events: all;
  animation: toast-in 0.25s ease;
  cursor: pointer;
}
.inapp-toast:hover { border-color: rgba(255,255,255,0.22); }
@keyframes toast-in {
  from { transform: translateX(32px); opacity: 0; }
  to   { transform: translateX(0);    opacity: 1; }
}
.inapp-toast-icon { font-size: 20px; flex-shrink: 0; }
.inapp-toast-body { flex: 1; min-width: 0; }
.inapp-toast-title { font-size: 13px; font-weight: 700; color: white; margin-bottom: 2px; }
.inapp-toast-msg   { font-size: 11px; color: rgba(255,255,255,0.55); line-height: 1.4; }
.inapp-toast-close { background: none; border: none; color: rgba(255,255,255,0.3); font-size: 14px; cursor: pointer; padding: 0; flex-shrink: 0; line-height: 1; }
.inapp-toast-close:hover { color: white; }

/* Favourites column wrapper — label + cards stacked */
.pro-favs-col {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  min-width: 0;
}

.pro-favs-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}

.pro-favs-label {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.6px;
  text-transform: uppercase;
  color: rgba(239, 68, 68, 0.75);
}

.pro-favs-hint {
  font-size: 10px;
  color: rgba(255,255,255,0.25);
  text-align: center;
}

/* Favourites row in hero — stat-style mini cards */
.pro-favs-row {
  display: flex;
  gap: 8px;
  justify-content: center;
  flex-wrap: wrap;
  align-items: center;
}

.pro-fav-stat {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 12px;
  padding: 8px 10px 6px;
  min-width: 56px;
  cursor: default;
  position: relative;
}

.pro-fav-remove {
  position: absolute;
  top: 3px;
  right: 3px;
  background: none;
  border: none;
  color: rgba(255,255,255,0.0);
  font-size: 9px;
  cursor: pointer;
  padding: 2px 4px;
  border-radius: 5px;
  transition: all 0.15s;
  line-height: 1;
  z-index: 2;
}
.pro-fav-stat:hover .pro-fav-remove { color: rgba(255,255,255,0.3); }
.pro-fav-remove:hover { color: #f87171 !important; background: rgba(239,68,68,0.12); }

.pro-fav-stat-icon {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
}

.pro-fav-stat-name {
  color: rgba(255,255,255,0.65);
  font-size: 9px;
  font-weight: 600;
  text-align: center;
  max-width: 60px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.pro-favs-empty {
  color: rgba(255,255,255,0.25);
  font-size: 11px;
  align-self: center;
  padding: 4px 0;
}

/* Profile tabs */
.pro-tabs {
  display: flex;
  gap: 6px;
  margin-bottom: 20px;
}

.pro-tab {
  flex: 1;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  color: rgba(255,255,255,0.4);
  font-size: 13px;
  font-weight: 500;
  padding: 11px 8px;
  border-radius: 14px;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.pro-tab:hover { color: rgba(255,255,255,0.75); background: rgba(255,255,255,0.07); }

.pro-tab.active {
  background: rgba(255,255,255,0.09);
  border-color: var(--tab-accent, rgba(255,255,255,0.2));
  color: white;
}

.pro-tab-icon { font-size: 14px; }

.pro-tab-badge {
  background: rgba(255,255,255,0.15);
  border-radius: 10px;
  padding: 1px 6px;
  font-size: 10px;
  font-weight: 600;
  color: white;
}

/* Empty state */
.pro-empty {
  text-align: center;
  padding: 60px 0;
}

.pro-empty-icon {
  font-size: 36px;
  margin-bottom: 12px;
  opacity: 0.3;
}

.pro-empty p {
  color: rgba(255,255,255,0.3);
  font-size: 13px;
  margin: 0;
}

/* Villager grid on profile */
.pro-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
  gap: 10px;
}

.pro-card {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 16px;
  padding: 14px 8px 10px;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  transition: background 0.15s, border-color 0.15s;
  cursor: pointer;
}

.pro-card:hover {
  background: rgba(255,255,255,0.08);
}

.pro-card-remove {
  position: absolute;
  top: 5px;
  right: 5px;
  background: none;
  border: none;
  color: rgba(255,255,255,0.0);
  font-size: 10px;
  cursor: pointer;
  padding: 3px 5px;
  border-radius: 6px;
  transition: all 0.15s;
  line-height: 1;
  z-index: 2;
}
.pro-card:hover .pro-card-remove { color: rgba(255,255,255,0.3); }
.pro-card-remove:hover { color: #f87171 !important; background: rgba(239,68,68,0.12); }

.pro-card.expanded {
  background: rgba(255,255,255,0.09);
  border-color: rgba(255,255,255,0.15);
}

.pro-card-icon {
  width: 46px;
  height: 46px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  position: relative;
}

.pro-card-badge {
  position: absolute;
  bottom: -2px; right: -2px;
  font-size: 11px;
  background: rgba(0,0,0,0.5);
  border-radius: 50%;
  width: 17px; height: 17px;
  display: flex; align-items:center; justify-content:center;
}

.pro-card-name {
  color: white;
  font-size: 11px;
  font-weight: 600;
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.pro-card-trait {
  color: rgba(255,255,255,0.3);
  font-size: 9px;
  text-align: center;
}

.pro-card-expanded {
  width: calc(100% + 28px);
  margin: 6px -14px -14px;
  padding: 10px 14px 12px;
  background: rgba(255,255,255,0.06);
  border-top: 1px solid rgba(255,255,255,0.1);
  border-radius: 0 0 15px 15px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.pro-card-detail {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 4px;
}

.pro-detail-label {
  color: rgba(255,255,255,0.35);
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  white-space: nowrap;
}

.pro-detail-val {
  color: rgba(255,255,255,0.85);
  font-size: 11px;
  font-weight: 600;
  text-align: right;
}

/* ===== OLD PROFILE HERO (kept for backward compat) ===== */
.profile-hero {
  display: flex;
  align-items: center;
  gap: 20px;
  margin-bottom: 32px;
  padding: 24px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 20px;
  backdrop-filter: blur(20px);
}

.profile-avatar-wrap {
  position: relative;
  width: 72px;
  height: 72px;
  border-radius: 50%;
  background: rgba(167, 139, 250, 0.2);
  border: 2px solid rgba(167, 139, 250, 0.4);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
  overflow: hidden;
  transition: border-color 0.2s;
}

.profile-avatar-wrap:hover {
  border-color: rgba(167,139,250,0.8);
}

.profile-avatar-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.profile-avatar-emoji {
  font-size: 36px;
  line-height: 1;
}

.profile-avatar-initials {
  color: white;
  font-size: 24px;
  font-weight: 700;
}

.profile-avatar-edit {
  position: absolute;
  bottom: 2px;
  right: 2px;
  background: rgba(0,0,0,0.6);
  border-radius: 50%;
  width: 20px;
  height: 20px;
  font-size: 11px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: rgba(255,255,255,0.8);
  opacity: 0;
  transition: opacity 0.15s;
}

.profile-avatar-wrap:hover .profile-avatar-edit {
  opacity: 1;
}

.profile-hero-info {
  flex: 1;
  min-width: 0;
}

.profile-hero-name {
  color: white;
  font-size: 22px;
  font-weight: 700;
  margin: 0 0 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.profile-hero-id {
  color: rgba(255,255,255,0.4);
  font-size: 13px;
  display: block;
  margin-bottom: 10px;
}

.profile-hero-stats {
  display: flex;
  gap: 14px;
}

.profile-hero-stats span {
  color: rgba(255,255,255,0.55);
  font-size: 12px;
}

.profile-logout-btn {
  background: none;
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 10px;
  color: rgba(255,255,255,0.45);
  font-size: 12px;
  padding: 8px 14px;
  cursor: pointer;
  transition: all 0.15s;
  flex-shrink: 0;
}

.profile-logout-btn:hover {
  border-color: rgba(239,68,68,0.5);
  color: rgba(239,68,68,0.8);
}

/* Avatar picker */
.avatar-picker-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  z-index: 400;
  display: flex;
  align-items: center;
  justify-content: center;
}

.avatar-picker {
  background: rgba(40, 28, 70, 0.92);
  backdrop-filter: blur(24px) saturate(140%);
  -webkit-backdrop-filter: blur(24px) saturate(140%);
  border: 1px solid rgba(255,255,255,0.18);
  border-top: 1px solid rgba(255,255,255,0.28);
  box-shadow: 0 16px 60px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.12);
  border-radius: 20px;
  padding: 20px;
  width: 320px;
  max-width: calc(100vw - 40px);
}

.avatar-picker-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  color: white;
  font-size: 14px;
  font-weight: 600;
}

.avatar-picker-header button {
  background: none;
  border: none;
  color: rgba(255,255,255,0.5);
  cursor: pointer;
  font-size: 14px;
  padding: 2px 6px;
}

.avatar-emoji-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 6px;
  margin-bottom: 14px;
}

.avatar-emoji-btn {
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 10px;
  font-size: 24px;
  padding: 8px;
  cursor: pointer;
  transition: background 0.15s, transform 0.1s;
  line-height: 1;
  opacity: 0.9;
}

.avatar-emoji-btn:hover {
  background: rgba(255,255,255,0.14);
  transform: scale(1.1);
  opacity: 1;
}

.avatar-upload-btn {
  width: 100%;
  background: none;
  border: 1px dashed rgba(255,255,255,0.2);
  border-radius: 10px;
  color: rgba(255,255,255,0.5);
  font-size: 13px;
  padding: 10px;
  cursor: pointer;
  transition: all 0.15s;
}

.avatar-upload-btn:hover {
  border-color: rgba(255,255,255,0.5);
  color: white;
}

/* Profile tabs */
.profile-tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 20px;
  background: rgba(255,255,255,0.04);
  border-radius: 14px;
  padding: 4px;
}

.profile-tab {
  flex: 1;
  background: none;
  border: none;
  color: rgba(255,255,255,0.45);
  font-size: 12px;
  font-weight: 500;
  padding: 9px 8px;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
  white-space: nowrap;
}

.profile-tab:hover {
  color: rgba(255,255,255,0.75);
}

.profile-tab.active {
  background: rgba(255,255,255,0.1);
  color: white;
}

.profile-tab-count {
  background: rgba(255,255,255,0.15);
  border-radius: 10px;
  padding: 1px 6px;
  font-size: 10px;
}

.profile-tab-content {
  min-height: 200px;
}

.profile-empty {
  color: rgba(255,255,255,0.35);
  font-size: 13px;
  font-style: italic;
  text-align: center;
  padding: 48px 0;
  margin: 0;
}

/* Villager mini-cards on profile */
.pv-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
  gap: 10px;
}

.pv-card {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 14px;
  padding: 12px 8px 10px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
}

.pv-icon-wrap {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
}

.pv-icon-wrap.gender-female {
  background: rgba(240, 0, 200, 0.15);
  border: 1.5px solid #f000c8;
  box-shadow: 0 0 10px rgba(240, 0, 200, 0.3);
}

.pv-icon-wrap.gender-male {
  background: rgba(60, 130, 255, 0.15);
  border: 1.5px solid rgba(60,130,255,0.5);
  box-shadow: 0 0 10px rgba(60,130,255,0.2);
}

.pv-name {
  color: white;
  font-size: 11px;
  font-weight: 600;
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.pv-trait {
  color: rgba(255,255,255,0.35);
  font-size: 9px;
  text-align: center;
}

/* ===== CHECKOUT MODAL ===== */
.checkout-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  z-index: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
}

.checkout-modal {
  background: linear-gradient(145deg, rgba(15,23,20,0.95) 0%, rgba(8,15,12,0.92) 100%);
  backdrop-filter: blur(24px) saturate(180%);
  -webkit-backdrop-filter: blur(24px) saturate(180%);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 20px;
  padding: 0;
  width: 100%;
  max-width: 520px;
  max-height: 85vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 1px rgba(255,255,255,0.05), inset 0 1px 0 rgba(255,255,255,0.1);
}

.checkout-modal::-webkit-scrollbar { display: none; }

.checkout-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 28px 28px 0;
  margin-bottom: 20px;
  flex-shrink: 0;
}

.checkout-title {
  color: white;
  font-size: 22px;
  font-weight: 700;
  margin: 0;
  letter-spacing: -0.3px;
  background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.checkout-close {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.6);
  font-size: 13px;
  cursor: pointer;
  padding: 8px 12px;
  border-radius: 12px;
  transition: all 0.2s ease;
  line-height: 1;
  flex-shrink: 0;
  font-weight: 500;
}
.checkout-close:hover { 
  background: rgba(255,255,255,0.12); 
  color: white; 
  transform: scale(1.05);
}

.checkout-sub {
  color: rgba(255,255,255,0.4);
  font-size: 12px;
  margin: 0;
  padding: 0 28px;
  text-align: center;
}

.checkout-items {
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow-y: auto;
  scrollbar-width: none;
  padding: 0 28px;
  flex: 1;
  margin-bottom: 20px;
}
.checkout-items::-webkit-scrollbar { display: none; }

.checkout-item {
  display: flex;
  gap: 16px;
  align-items: flex-start;
  background: linear-gradient(145deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.03) 100%);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 18px;
  padding: 16px;
  transition: all 0.2s ease;
}
.checkout-item:hover {
  background: linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.05) 100%);
  border-color: rgba(255,255,255,0.12);
}

.checkout-item-icon {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  flex-shrink: 0;
}

.checkout-item-info {
  flex: 1;
  min-width: 0;
}

.checkout-item-name {
  display: block;
  color: white;
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 2px;
  letter-spacing: -0.2px;
}

.checkout-item-species {
  display: block;
  color: rgba(255,255,255,0.35);
  font-size: 11px;
  margin-bottom: 8px;
}

.checkout-offer-input {
  width: 100%;
  background: linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.04) 100%);
  border: 1px solid rgba(255,255,255,0.15);
  color: white;
  border-radius: 10px;
  padding: 10px 14px;
  font-size: 14px;
  font-family: inherit;
  resize: none;
  min-height: 54px;
  box-sizing: border-box;
  transition: all 0.2s ease;
  font-weight: 500;
}

.checkout-offer-input::placeholder { color: rgba(255,255,255,0.5); }
.checkout-offer-input:focus { 
  outline: none; 
  border-color: rgba(167,139,250,0.6);
  background: linear-gradient(145deg, rgba(255,255,255,0.12) 0%, rgba(255,255,255,0.06) 100%);
  box-shadow: 0 0 0 3px rgba(167,139,250,0.1);
}

.checkout-login-note {
  color: rgba(255,255,255,0.4);
  font-size: 12px;
  margin-bottom: 12px;
  padding: 0 24px;
  flex-shrink: 0;
}

.checkout-submit-btn {
  margin: 0 24px 24px;
  flex-shrink: 0;
  background: linear-gradient(135deg, rgba(167,139,250,0.28) 0%, rgba(52,211,153,0.22) 100%);
  border: 1px solid rgba(167,139,250,0.4);
  border-radius: 16px;
  padding: 14px 20px;
  color: white;
  font-weight: 800;
  font-size: 15px;
  cursor: pointer;
  transition: all 0.2s;
  letter-spacing: -0.2px;
  width: calc(100% - 48px);
}
.checkout-submit-btn:hover:not(:disabled) { background: linear-gradient(135deg, rgba(167,139,250,0.38) 0%, rgba(52,211,153,0.32) 100%); transform: translateY(-1px); box-shadow: 0 8px 24px rgba(0,0,0,0.35); }
.checkout-submit-btn:disabled { opacity: 0.4; cursor: not-allowed; }

.checkout-success {
  text-align: center;
  padding: 48px 24px;
  color: white;
}

.checkout-success-icon {
  font-size: 40px;
  color: #22c55e;
  margin-bottom: 12px;
}

.checkout-success p { margin: 0 0 6px; font-size: 16px; font-weight: 600; }

.checkout-success-sub {
  color: rgba(255,255,255,0.45);
  font-size: 12px !important;
  font-weight: 400 !important;
}

/* ===== OFFER TYPE BUTTONS ===== */
.offer-type-label {
  font-size: 11px;
  font-weight: 600;
  color: rgba(255,255,255,0.4);
  margin-bottom: 8px;
  letter-spacing: 0.2px;
  text-transform: uppercase;
}

.offer-type-row {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 8px;
}

.offer-type-btn {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 20px;
  color: rgba(255,255,255,0.6);
  font-size: 12px;
  font-weight: 600;
  padding: 5px 12px;
  cursor: pointer;
  transition: all 0.15s cubic-bezier(0.22,1,0.36,1);
  font-family: inherit;
}

.offer-type-btn:hover {
  background: rgba(255,255,255,0.11);
  color: white;
}

.offer-type-btn.active {
  background: rgba(52,211,153,0.2);
  border-color: rgba(52,211,153,0.5);
  color: #6ee7b7;
}

/* ===== LEGAL PAGES ===== */
.legal-screen {
  min-height: 100vh;
  background: #0f1117;
  padding: 24px 0 60px;
  position: relative;
}

.legal-container {
  max-width: 720px;
  margin: 0 auto;
  padding: 0 24px;
}

.legal-header {
  text-align: center;
  padding: 60px 0 40px;
  border-bottom: 1px solid rgba(255,255,255,0.07);
  margin-bottom: 40px;
}

.legal-logo {
  font-size: 40px;
  margin-bottom: 12px;
}

.legal-title {
  font-size: 32px;
  font-weight: 900;
  color: white;
  margin: 0 0 8px;
  letter-spacing: -0.8px;
}

.legal-subtitle {
  font-size: 13px;
  color: rgba(255,255,255,0.35);
  margin: 0;
}

.legal-body {
  color: rgba(255,255,255,0.75);
  line-height: 1.7;
  font-size: 14px;
}

.legal-body h2 {
  color: white;
  font-size: 16px;
  font-weight: 800;
  margin: 32px 0 10px;
  letter-spacing: -0.3px;
}

.legal-body p {
  margin: 0 0 14px;
}

.legal-body ul {
  padding-left: 20px;
  margin: 0 0 14px;
}

.legal-body ul li {
  margin-bottom: 6px;
}

.legal-body strong {
  color: white;
  font-weight: 700;
}

/* Legal checkboxes on signup */
.legal-checks {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 4px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 12px;
  padding: 12px 14px;
}

.legal-check-row {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  cursor: pointer;
  font-size: 12px;
  color: rgba(255,255,255,0.6);
  line-height: 1.5;
}

.legal-check-row input[type="checkbox"] {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
  margin-top: 2px;
  accent-color: #34d399;
  cursor: pointer;
}

.legal-check-row .link-btn {
  color: #6ee7b7;
  text-decoration: underline;
  text-underline-offset: 2px;
}

/* ===== GIVER CHECK MODAL ===== */
.giver-check-modal {
  background: linear-gradient(160deg, rgba(30,35,30,0.98) 0%, rgba(20,25,20,0.98) 100%);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 20px;
  padding: 32px 28px;
  max-width: 380px;
  width: 90vw;
  text-align: center;
  box-shadow: 0 24px 64px rgba(0,0,0,0.6);
}
.giver-check-icon { font-size: 38px; margin-bottom: 12px; }
.giver-check-title { color: white; font-size: 17px; font-weight: 700; margin: 0 0 8px; }
.giver-check-sub { color: rgba(255,255,255,0.45); font-size: 12px; margin: 0 0 22px; line-height: 1.5; }
.giver-check-btns { display: flex; flex-direction: column; gap: 9px; }
.giver-check-btn {
  width: 100%;
  padding: 11px 16px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.1);
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  font-family: inherit;
  transition: all 0.15s;
}
.giver-check-btn.yes {
  background: rgba(34,197,94,0.12);
  border-color: rgba(34,197,94,0.3);
  color: #4ade80;
}
.giver-check-btn.yes:hover { background: rgba(34,197,94,0.22); }
.giver-check-btn.no {
  background: rgba(239,68,68,0.1);
  border-color: rgba(239,68,68,0.25);
  color: #f87171;
}
.giver-check-btn.no:hover { background: rgba(239,68,68,0.18); }

/* ===== TRADES PAGE (tr-* classes) ===== */
.trades-page {
  min-height: 100vh;
  padding: 72px 28px 60px 310px;
  background: linear-gradient(160deg, #0f1108 0%, #181a06 40%, #12140a 100%);
}

.tr-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: 28px;
}

.tr-title {
  color: white;
  font-size: 28px;
  font-weight: 800;
  margin: 0 0 4px;
  letter-spacing: -0.3px;
}

.tr-sub {
  color: rgba(255,255,255,0.35);
  font-size: 12px;
  margin: 0;
}

.tr-alert-badge {
  background: rgba(239,68,68,0.15);
  border: 1px solid rgba(239,68,68,0.35);
  color: #f87171;
  font-size: 11px;
  font-weight: 700;
  border-radius: 20px;
  padding: 4px 12px;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

/* Tab switcher */
.tr-tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 22px;
}

.tr-tab {
  flex: 1;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  color: rgba(255,255,255,0.4);
  font-size: 13px;
  font-weight: 500;
  padding: 12px 12px;
  border-radius: 14px;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.tr-tab:hover { color: rgba(255,255,255,0.75); background: rgba(255,255,255,0.07); }

.tr-tab.active {
  background: rgba(255,255,255,0.08);
  border-color: rgba(255,255,255,0.15);
  color: white;
}

.tr-tab-dot {
  width: 7px; height: 7px;
  border-radius: 50%;
  flex-shrink: 0;
}
.tr-tab-dot.incoming { background: #ef4444; }
.tr-tab-dot.my       { background: #60a5fa; }

@media (max-width: 600px) {
  .tr-tab {
    font-size: 9px;
    padding: 6px 2px;
    gap: 2px;
    border-radius: 8px;
    flex: 1;
    min-width: 0;
  }
  .tr-tab-dot { display: none; }
  .tr-tab-count { padding: 1px 4px; font-size: 8px; }
}

.tr-tab-count {
  background: rgba(255,255,255,0.12);
  border-radius: 10px;
  padding: 1px 7px;
  font-size: 10px;
  font-weight: 700;
}

/* Empty state */
.tr-empty {
  text-align: center;
  padding: 70px 0 40px;
}

.tr-empty-icon {
  font-size: 40px;
  margin-bottom: 14px;
  opacity: 0.5;
}

.tr-empty p {
  color: rgba(255,255,255,0.4);
  font-size: 14px;
  margin: 0 0 8px;
  font-weight: 500;
}

.tr-empty-hint {
  color: rgba(255,255,255,0.2);
  font-size: 11px;
  display: block;
}

/* Trade list */
.tr-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

/* Individual trade card — new tr-card design */
.tr-card {
  display: flex;
  align-items: center;
  gap: 0;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 18px;
  overflow: hidden;
  transition: background 0.15s, border-color 0.15s;
  position: relative;
}

.tr-card:hover {
  background: rgba(255,255,255,0.07);
  border-color: rgba(255,255,255,0.12);
}

.tr-card-stripe {
  width: 4px;
  align-self: stretch;
  flex-shrink: 0;
  opacity: 0.7;
}

.tr-card-icon {
  width: 52px;
  height: 52px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
  flex-shrink: 0;
  margin: 14px 4px 14px 14px;
}

.tr-card-body {
  flex: 1;
  min-width: 0;
  padding: 14px 12px 14px 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.tr-card-row1 {
  display: flex;
  align-items: center;
  gap: 8px;
}

.tr-card-name {
  color: white;
  font-size: 15px;
  font-weight: 700;
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.tr-card-status-pill {
  font-size: 10px;
  font-weight: 700;
  border-radius: 20px;
  padding: 2px 9px;
  white-space: nowrap;
  flex-shrink: 0;
}

.tr-card-from {
  display: flex;
  align-items: center;
  gap: 5px;
  color: rgba(255,255,255,0.35);
  font-size: 11px;
}

.tr-card-from-icon { font-size: 10px; }

.tr-card-offer {
  color: rgba(255,255,255,0.6);
  font-size: 12px;
  font-style: italic;
  margin: 0;
  padding: 5px 10px;
  border-left: 2px solid rgba(255,255,255,0.15);
  border-radius: 0 4px 4px 0;
  background: rgba(255,255,255,0.03);
}

.tr-card-no-offer {
  color: rgba(255,255,255,0.18);
  font-size: 11px;
  font-style: italic;
}

.tr-card-role-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 4px 0;
}

.tr-card-role {
  font-size: 11px;
  font-weight: 600;
  color: rgba(255,255,255,0.7);
  background: rgba(255,255,255,0.1);
  padding: 2px 6px;
  border-radius: 4px;
}

.tr-card-other-user {
  font-size: 11px;
  color: rgba(255,255,255,0.5);
  font-weight: 500;
}

.tr-card-progress {
  margin: 6px 0;
}

.tr-progress-bar {
  display: flex;
  align-items: center;
  gap: 2px;
}

.tr-progress-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 1;
  position: relative;
}

.tr-progress-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: rgba(255,255,255,0.2);
  margin-bottom: 2px;
  transition: all 0.2s ease;
}

.tr-progress-step.completed .tr-progress-dot {
  background: #4ade80;
  box-shadow: 0 0 4px rgba(74,222,128,0.4);
}

.tr-progress-label {
  font-size: 8px;
  color: rgba(255,255,255,0.4);
  text-align: center;
  line-height: 1.2;
}

.tr-card-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 4px;
}

.tr-card-expand-hint {
  font-size: 10px;
  color: rgba(255,255,255,0.3);
  cursor: pointer;
}

.tr-card-expanded {
  border-top: 1px solid rgba(255,255,255,0.1);
  background: rgba(0,0,0,0.2);
}

.tr-card-expanded-content {
  padding: 16px;
}

.tr-expanded-section {
  margin-bottom: 16px;
}

.tr-expanded-section h4 {
  color: white;
  font-size: 12px;
  font-weight: 600;
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.tr-expanded-section p {
  color: rgba(255,255,255,0.6);
  font-size: 11px;
  margin: 4px 0;
}

.tr-chat-container {
  background: rgba(0,0,0,0.3);
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.1);
}

.tr-chat-messages {
  max-height: 120px;
  overflow-y: auto;
  padding: 8px;
}

.tr-chat-empty {
  text-align: center;
  color: rgba(255,255,255,0.4);
  font-size: 11px;
  font-style: italic;
  padding: 16px;
}

.tr-chat-loading {
  text-align: center;
  color: rgba(255,255,255,0.5);
  font-size: 11px;
  padding: 16px;
}

.tr-chat-message {
  margin-bottom: 6px;
  display: flex;
  flex-direction: column;
}

.tr-chat-message.sent {
  align-items: flex-end;
}

.tr-chat-message.received {
  align-items: flex-start;
}

.tr-chat-text {
  background: rgba(167,139,250,0.2);
  color: white;
  padding: 4px 8px;
  border-radius: 8px;
  font-size: 11px;
  max-width: 80%;
}

.tr-chat-message.received .tr-chat-text {
  background: rgba(255,255,255,0.1);
}

.tr-chat-time {
  font-size: 9px;
  color: rgba(255,255,255,0.3);
  margin-top: 2px;
}

.tr-chat-input-container {
  display: flex;
  gap: 4px;
  padding: 8px;
  border-top: 1px solid rgba(255,255,255,0.1);
}

.tr-chat-input {
  flex: 1;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  color: white;
  padding: 6px 8px;
  border-radius: 4px;
  font-size: 11px;
}

.tr-chat-input::placeholder {
  color: rgba(255,255,255,0.4);
}

.tr-chat-send-btn {
  background: rgba(167,139,250,0.3);
  border: 1px solid rgba(167,139,250,0.4);
  color: white;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.tr-chat-send-btn:hover:not(:disabled) {
  background: rgba(167,139,250,0.4);
}

.tr-chat-send-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.tr-accept-btn-large {
  width: 100%;
  background: linear-gradient(135deg, rgba(74,222,128,0.3) 0%, rgba(34,197,94,0.2) 100%);
  border: 1px solid rgba(74,222,128,0.4);
  color: white;
  padding: 16px;
  border-radius: 12px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 16px;
}

.tr-accept-btn-large:hover:not(:disabled) {
  background: linear-gradient(135deg, rgba(74,222,128,0.4) 0%, rgba(34,197,94,0.3) 100%);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(74,222,128,0.3);
}

.tr-accept-btn-large:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.tr-danger-zone {
  border: 1px solid rgba(239,68,68,0.2);
  background: rgba(239,68,68,0.05);
  border-radius: 8px;
  padding: 16px;
  margin-top: 20px;
}

.tr-danger-zone h4 {
  color: #f87171;
  margin-bottom: 8px;
}

.tr-danger-warning {
  color: rgba(248,113,113,0.8);
  font-size: 12px;
  margin-bottom: 12px;
  font-weight: 500;
}

.tr-cancel-btn-danger {
  width: 100%;
  background: rgba(239,68,68,0.1);
  border: 1px solid rgba(239,68,68,0.3);
  color: #f87171;
  padding: 12px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.tr-cancel-btn-danger:hover:not(:disabled) {
  background: rgba(239,68,68,0.2);
  border-color: rgba(239,68,68,0.4);
  transform: translateY(-1px);
}

.tr-cancel-btn-danger:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.tr-expanded-actions {
  display: flex;
  gap: 8px;
  margin-top: 12px;
}

.tr-incoming-actions {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-left: auto;
  padding-right: 8px;
}

.tr-ongoing-chat-toggle {
  padding: 8px 16px;
  border-top: 1px solid rgba(255,255,255,0.1);
}

.tr-chat-toggle-btn {
  width: 100%;
  background: rgba(167,139,250,0.2);
  border: 1px solid rgba(167,139,250,0.3);
  color: white;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.tr-chat-toggle-btn:hover {
  background: rgba(167,139,250,0.3);
  transform: translateY(-1px);
}

.tr-ongoing-chat {
  border-top: 1px solid rgba(255,255,255,0.1);
  background: rgba(0,0,0,0.3);
}

.tr-card-time {
  color: rgba(255,255,255,0.2);
  font-size: 10px;
}

/* Amiibo Verification Modal */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  backdrop-filter: blur(4px);
}

.amiibo-verification-modal {
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 16px;
  padding: 0;
  max-width: 480px;
  width: 90%;
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
  overflow: hidden;
}

.modal-header {
  background: rgba(167,139,250,0.1);
  padding: 20px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  text-align: center;
}

.modal-header h3 {
  color: white;
  margin: 0;
  font-size: 18px;
  font-weight: 600;
}

.modal-body {
  padding: 24px;
}

.amiibo-question {
  text-align: center;
  margin-bottom: 24px;
}

.amiibo-question p {
  color: rgba(255,255,255,0.8);
  font-size: 16px;
  margin-bottom: 16px;
}

.amiibo-villager-display {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  background: rgba(255,255,255,0.05);
  padding: 12px 20px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.1);
}

.amiibo-villager-icon {
  font-size: 24px;
}

.amiibo-villager-name {
  color: white;
  font-size: 18px;
  font-weight: 600;
}

.amiibo-options {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.amiibo-option {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 12px;
  padding: 16px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.amiibo-option:hover {
  background: rgba(255,255,255,0.05);
  border-color: rgba(167,139,250,0.3);
}

.amiibo-option-btn {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  padding: 16px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: white;
  font-size: 14px;
  font-weight: 500;
  text-align: left;
}

.amiibo-option-btn:hover {
  background: rgba(255,255,255,0.05);
  border-color: rgba(167,139,250,0.3);
  transform: translateY(-1px);
}

.amiibo-option-btn.yes:hover {
  border-color: rgba(74,222,128,0.4);
  background: rgba(74,222,128,0.1);
}

.amiibo-option-btn.no:hover {
  border-color: rgba(239,68,68,0.4);
  background: rgba(239,68,68,0.1);
}

.option-icon {
  font-size: 20px;
  flex-shrink: 0;
  margin-top: 2px;
}

.option-text {
  color: white;
  font-size: 14px;
  font-weight: 500;
  display: block;
  margin-bottom: 4px;
}

.option-desc {
  color: rgba(255,255,255,0.6);
  font-size: 12px;
  line-height: 1.4;
  display: block;
}

.modal-footer {
  background: rgba(0,0,0,0.2);
  padding: 20px;
  border-top: 1px solid rgba(255,255,255,0.1);
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

.modal-btn {
  padding: 10px 20px;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.modal-btn-cancel {
  background: rgba(255,255,255,0.1);
  color: rgba(255,255,255,0.7);
  border: 1px solid rgba(255,255,255,0.2);
}

.modal-btn-cancel:hover {
  background: rgba(255,255,255,0.15);
  color: white;
}

.modal-btn-confirm {
  background: linear-gradient(135deg, rgba(74,222,128,0.3) 0%, rgba(34,197,94,0.2) 100%);
  color: white;
  border: 1px solid rgba(74,222,128,0.4);
}

.modal-btn-confirm:hover {
  background: linear-gradient(135deg, rgba(74,222,128,0.4) 0%, rgba(34,197,94,0.3) 100%);
  transform: translateY(-1px);
}

/* Accept button */
.tr-accept-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 3px;
  background: rgba(34,197,94,0.1);
  border: none;
  border-left: 1px solid rgba(34,197,94,0.2);
  color: #4ade80;
  font-size: 11px;
  font-weight: 700;
  padding: 0 18px;
  cursor: pointer;
  flex-shrink: 0;
  align-self: stretch;
  transition: background 0.15s;
  min-width: 62px;
}

.tr-accept-btn:hover {
  background: rgba(34,197,94,0.22);
}

.tr-accept-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.tr-cancel-req-btn {
  flex-shrink: 0;
  align-self: center;
  padding: 6px 12px;
  border-radius: 8px;
  border: 1px solid rgba(239,68,68,0.35);
  background: rgba(239,68,68,0.08);
  color: #f87171;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  white-space: nowrap;
  transition: background 0.15s;
}
.tr-cancel-req-btn:hover {
  background: rgba(239,68,68,0.18);
}
.tr-cancel-req-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.tr-accept-icon {
  font-size: 18px;
  line-height: 1;
}

.tr-accept-loading {
  font-size: 18px;
}

/* ===== ONGOING TRADE CARD ===== */
.tr-ongoing-card {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 18px;
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  margin-bottom: 12px;
}

.tr-ongoing-header {
  display: flex;
  align-items: center;
  gap: 12px;
  user-select: none;
}

.tr-expand-chevron {
  font-size: 9px;
  color: rgba(255,255,255,0.3);
  flex-shrink: 0;
}

.tr-ongoing-header-info {
  display: flex;
  flex-direction: column;
  gap: 3px;
}

.tr-ongoing-role {
  color: rgba(255,255,255,0.45);
  font-size: 11px;
}

/* Progress bar */
.tr-progress-bar-wrap {
  position: relative;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding-top: 8px;
  padding-bottom: 4px;
}

.tr-progress-line-bg {
  position: absolute;
  top: 18px;
  left: 14px;
  right: 14px;
  height: 2px;
  background: rgba(255,255,255,0.1);
  z-index: 0;
}

.tr-progress-line-fill {
  position: absolute;
  top: 18px;
  left: 14px;
  height: 2px;
  background: linear-gradient(90deg, #4ade80, #fbbf24);
  z-index: 1;
  transition: width 0.4s ease;
}

.tr-progress-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  flex: 1;
  position: relative;
  z-index: 2;
}

.tr-progress-dot {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  border: 2px solid rgba(255,255,255,0.15);
  background: rgba(15, 26, 8, 0.9);
  color: rgba(255,255,255,0.3);
  transition: all 0.2s;
}

.tr-progress-step.done .tr-progress-dot {
  background: rgba(74, 222, 128, 0.2);
  border-color: #4ade80;
  color: #4ade80;
}

.tr-progress-step.active .tr-progress-dot {
  background: rgba(251, 191, 36, 0.2);
  border-color: #fbbf24;
  color: #fbbf24;
  box-shadow: 0 0 12px rgba(251,191,36,0.3);
}

.tr-progress-label {
  font-size: 9px;
  color: rgba(255,255,255,0.3);
  text-align: center;
  max-width: 60px;
  line-height: 1.2;
}

.tr-progress-step.active .tr-progress-label {
  color: rgba(255,255,255,0.7);
  font-weight: 600;
}

.tr-progress-step.done .tr-progress-label {
  color: rgba(74, 222, 128, 0.7);
}

/* Ongoing body / actions */
.tr-ongoing-body {
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 12px;
  background: rgba(255,255,255,0.04);
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.06);
}

.tr-ongoing-desc {
  color: rgba(255,255,255,0.7);
  font-size: 13px;
  line-height: 1.5;
  margin: 0;
}

.tr-step-btn {
  padding: 8px 16px;
  border-radius: 10px;
  border: none;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: opacity 0.15s, transform 0.1s;
  font-family: inherit;
  align-self: flex-start;
}

.tr-step-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.tr-step-btn:not(:disabled):hover {
  transform: translateY(-1px);
  opacity: 0.9;
}

.tr-step-btn.confirm {
  background: rgba(74, 222, 128, 0.18);
  color: #4ade80;
  border: 1px solid rgba(74,222,128,0.3);
}

.tr-step-btn.proceed {
  background: rgba(251, 191, 36, 0.18);
  color: #fbbf24;
  border: 1px solid rgba(251,191,36,0.3);
}

.tr-step-btn.complete {
  background: rgba(167, 139, 250, 0.18);
  color: #a78bfa;
  border: 1px solid rgba(167,139,250,0.3);
}

.tr-step-btn.report {
  background: rgba(248, 113, 113, 0.18);
  color: #f87171;
  border: 1px solid rgba(248,113,113,0.3);
}

.tr-step-btn.cancel {
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.5);
  border: 1px solid rgba(255,255,255,0.1);
}

/* Softer cancel — less prominent than action buttons */
.tr-step-btn.cancel-soft {
  background: transparent;
  color: rgba(255,255,255,0.28);
  border: 1px solid rgba(255,255,255,0.08);
  font-size: 11px;
  padding: 5px 12px;
}
.tr-step-btn.cancel-soft:not(:disabled):hover {
  color: rgba(248,113,113,0.7);
  border-color: rgba(248,113,113,0.2);
}

/* Expire — amber, less alarming than red */
.tr-step-btn.expire {
  background: rgba(251,191,36,0.08);
  color: rgba(251,191,36,0.5);
  border: 1px solid rgba(251,191,36,0.15);
  font-size: 11px;
  padding: 5px 12px;
}

/* Cancel row — pushes cancel to bottom, right-aligned */
.tr-cancel-row {
  display: flex;
  justify-content: flex-end;
  margin-top: 4px;
  padding-top: 4px;
  border-top: 1px solid rgba(255,255,255,0.05);
}

.tr-step-confirmed {
  color: #4ade80;
  font-size: 12px;
  font-weight: 600;
}

.tr-step-waiting {
  color: rgba(255,255,255,0.4);
  font-size: 12px;
  font-style: italic;
}

.tr-step-hint {
  color: rgba(255,255,255,0.3);
  font-size: 11px;
}

/* Dodo code input + reveal */
.tr-dodo-row {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
}

.tr-dodo-input {
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 8px;
  color: white;
  font-size: 13px;
  padding: 7px 12px;
  outline: none;
  font-family: inherit;
  flex: 1;
  min-width: 0;
}

.tr-dodo-input:focus {
  border-color: rgba(251,191,36,0.5);
}

.tr-dodo-reveal {
  display: flex;
  align-items: center;
  gap: 10px;
  background: rgba(251, 191, 36, 0.08);
  border: 1px solid rgba(251,191,36,0.2);
  border-radius: 10px;
  padding: 10px 14px;
}

.tr-dodo-label {
  color: rgba(255,255,255,0.4);
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.tr-dodo-code {
  font-size: 22px;
  font-weight: 800;
  color: #fbbf24;
  letter-spacing: 4px;
  font-family: monospace;
}

/* ===== TRADE CHAT PANEL ===== */
.tc-panel {
  border-top: 1px solid rgba(255,255,255,0.08);
  margin-top: 14px;
  padding-top: 10px;
}

.tc-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 8px;
}

.tc-header-icon { font-size: 13px; }

.tc-header-info {
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.tc-header-label {
  font-size: 12px;
  font-weight: 700;
  color: rgba(255,255,255,0.75);
  letter-spacing: -0.1px;
}

.tc-header-status {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 11px;
  color: rgba(255,255,255,0.45);
}

.feedback-user-info {
  text-align: center;
  margin: 16px 0;
  font-size: 14px;
  color: rgba(255,255,255,0.6);
}

.feedback-form button[type="submit"] {
  margin-top: 20px;
  margin-bottom: 20px;
  max-width: 900px;
  width: 100%;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.tc-messages {
  display: flex;
  flex-direction: column;
  gap: 4px;
  max-height: 180px;
  overflow-y: auto;
  margin-bottom: 8px;
  scrollbar-width: none;
}
.tc-messages::-webkit-scrollbar { display: none; }

.tc-empty {
  color: rgba(255,255,255,0.2);
  font-size: 11px;
  text-align: center;
  padding: 10px 0;
  font-style: italic;
}

/* ===== HISTORY CARD ===== */
.tr-history-card {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 14px;
  padding: 14px;
  display: flex;
  align-items: flex-start;
  gap: 12px;
  margin-bottom: 8px;
}

.tr-reported-badge {
  color: #f87171;
  font-size: 11px;
  font-weight: 600;
  background: rgba(248,113,113,0.1);
  border: 1px solid rgba(248,113,113,0.2);
  border-radius: 6px;
  padding: 2px 7px;
  display: inline-block;
  margin-top: 4px;
}

.tr-report-btn {
  background: none;
  border: 1px solid rgba(248,113,113,0.25);
  border-radius: 8px;
  color: rgba(248,113,113,0.6);
  font-size: 11px;
  padding: 5px 10px;
  cursor: pointer;
  flex-shrink: 0;
  font-family: inherit;
  transition: color 0.15s, border-color 0.15s;
  white-space: nowrap;
  margin-left: auto;
}

.tr-report-btn:hover {
  color: #f87171;
  border-color: rgba(248,113,113,0.5);
}

.tr-report-row {
  display: flex;
  gap: 6px;
  align-items: center;
  flex-wrap: wrap;
  margin-left: auto;
  flex: 1;
}

/* ===== FEEDBACK PAGE ===== */
.feedback-page {
  width: 100%;
  max-width: 100%;
  padding: 16px;
  margin-left: 352px; /* 320px sidebar + 32px margin */
}

/* Feedback Ticket Styling (inside standard sidebar) */
.feedback-loading {
  color: rgba(255,255,255,0.5);
  text-align: center;
  padding: 20px;
  font-size: 14px;
}

.feedback-empty {
  text-align: center;
  padding: 40px 20px;
}

.feedback-empty-icon {
  font-size: 32px;
  margin-bottom: 12px;
}

.feedback-empty p {
  color: white;
  margin: 0 0 8px 0;
  font-weight: 500;
}

.feedback-empty span {
  color: rgba(255,255,255,0.5);
  font-size: 14px;
}

.feedback-ticket-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.feedback-ticket {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 12px;
  padding: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.feedback-ticket:hover {
  background: rgba(255,255,255,0.05);
  border-color: rgba(167,139,250,0.3);
}

.feedback-ticket.selected {
  background: rgba(167,139,250,0.1);
  border-color: rgba(167,139,250,0.4);
}

.feedback-ticket-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.feedback-ticket-category {
  background: rgba(167,139,250,0.2);
  color: white;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 500;
}

.feedback-ticket-date {
  color: rgba(255,255,255,0.5);
  font-size: 11px;
}

.feedback-ticket-preview {
  color: rgba(255,255,255,0.7);
  font-size: 12px;
  line-height: 1.3;
  margin-bottom: 8px;
}

.feedback-ticket-actions {
  display: flex;
  justify-content: flex-end;
}

.feedback-chat-btn {
  background: linear-gradient(135deg, rgba(74,222,128,0.3) 0%, rgba(34,197,94,0.2) 100%);
  border: 1px solid rgba(74,222,128,0.4);
  color: white;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 11px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.feedback-chat-btn:hover {
  background: linear-gradient(135deg, rgba(74,222,128,0.4) 0%, rgba(34,197,94,0.3) 100%);
  transform: translateY(-1px);
}

/* Override fixed positioning inside flex feedback layout */
.feedback-page .fb-sidebar {
  position: sticky;
  top: 16px;
  left: unset;
  bottom: unset;
  height: calc(100vh - 32px);
  flex-shrink: 0;
  align-self: flex-start;
  margin: 16px 0 16px 16px;
}

/* Left sidebar — nav + history */
.fb-sidebar {
  position: fixed;
  top: 16px;
  left: 16px;
  bottom: 16px;
  width: 270px;
  z-index: 100;
  border-radius: 20px;
  display: flex;
  flex-direction: column;
  background: linear-gradient(160deg, rgba(12,24,10,0.55) 0%, rgba(8,16,8,0.48) 100%);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border: 1px solid rgba(255,255,255,0.10);
  border-top: 1px solid rgba(255,255,255,0.18);
  border-left: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 8px 48px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
  overflow: hidden;
  padding: 0;
}

.fb-sidebar-close { display: none; }

.fb-history {
  flex: 1;
  overflow-y: auto;
  padding: 12px 16px 16px;
  scrollbar-width: none;
}
.fb-history::-webkit-scrollbar { display: none; }

.fb-history-title {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.6px;
  color: rgba(255,255,255,0.3);
  padding: 8px 0 10px;
}

.fb-history-empty {
  font-size: 12px;
  color: rgba(255,255,255,0.2);
  font-style: italic;
  padding: 8px 0;
}

.fb-history-item {
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 12px;
  padding: 10px 12px;
  margin-bottom: 8px;
  background: rgba(255,255,255,0.03);
  transition: background 0.15s, border-color 0.15s;
}
.fb-history-item:hover {
  background: rgba(255,255,255,0.055);
  border-color: rgba(255,255,255,0.11);
}
.fb-history-item.fb-history-item-open {
  background: rgba(255,255,255,0.055);
  border-color: rgba(167,139,250,0.2);
}

.fb-history-item-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 5px;
}

.fb-replied-badge {
  font-size: 9px;
  font-weight: 700;
  color: #4ade80;
  background: rgba(74,222,128,0.1);
  border: 1px solid rgba(74,222,128,0.2);
  border-radius: 8px;
  padding: 1px 6px;
  flex-shrink: 0;
}

.fb-history-pending {
  margin-top: 6px;
  font-size: 11px;
  color: rgba(255,255,255,0.3);
  font-style: italic;
}

.fb-history-msg {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.fb-history-cat {
  font-size: 10px;
  font-weight: 700;
  color: rgba(167,139,250,0.7);
  text-transform: uppercase;
  letter-spacing: 0.4px;
  margin-bottom: 4px;
}

.fb-history-msg {
  font-size: 12px;
  color: rgba(255,255,255,0.65);
  line-height: 1.4;
  margin-bottom: 4px;
  word-break: break-word;
}

.fb-history-time {
  font-size: 10px;
  color: rgba(255,255,255,0.2);
}

.fb-history-reply {
  margin-top: 8px;
  padding: 8px 10px;
  background: rgba(74,222,128,0.07);
  border: 1px solid rgba(74,222,128,0.15);
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  gap: 3px;
}

.fb-reply-label {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  color: #4ade80;
  letter-spacing: 0.4px;
}

.fb-reply-text {
  font-size: 12px;
  color: rgba(255,255,255,0.7);
  line-height: 1.4;
}

/* Main area — fills remaining space next to sidebar */
.fb-main {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px 28px;
  min-height: 100vh;
  min-width: 0;
}

.fb-form-card {
  width: 100%;
  max-width: 520px;
}

.feedback-header {
  margin-bottom: 28px;
}

.feedback-icon {
  font-size: 32px;
  display: block;
  margin-bottom: 10px;
}

.feedback-title {
  font-size: 24px;
  font-weight: 700;
  color: white;
  margin: 0 0 6px;
}

.feedback-sub {
  color: rgba(255,255,255,0.45);
  font-size: 13px;
  margin: 0;
}

.feedback-form {
  display: flex;
  flex-direction: column;
  gap: 14px;
}

.feedback-categories {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.feedback-cat-btn {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 20px;
  color: rgba(255,255,255,0.5);
  font-size: 12px;
  padding: 6px 14px;
  cursor: pointer;
  transition: all 0.15s;
}
.feedback-cat-btn:hover { background: rgba(255,255,255,0.1); color: white; }
.feedback-cat-btn.active {
  background: rgba(167,139,250,0.2);
  border-color: rgba(167,139,250,0.5);
  color: #c4b5fd;
}

.feedback-textarea {
  width: 100%;
  max-width: 900px;
  min-height: 80px;
  max-height: 200px;
  padding: 12px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 12px;
  color: white;
  font-family: inherit;
  font-size: 14px;
  resize: vertical;
  transition: all 0.2s ease;
}
.feedback-textarea:focus { border-color: rgba(167,139,250,0.4); }
.feedback-textarea::placeholder { color: rgba(255,255,255,0.25); }

.feedback-char-count {
  font-size: 11px;
  color: rgba(255,255,255,0.25);
  text-align: right;
  margin-top: -8px;
}

.feedback-user-info {
  font-size: 12px;
  color: rgba(255,255,255,0.3);
}
.feedback-user-info strong { color: rgba(255,255,255,0.6); }

.feedback-success {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 14px;
  padding: 40px 0;
  color: rgba(255,255,255,0.6);
  font-size: 15px;
}

.feedback-success-icon {
  font-size: 28px;
  background: rgba(74,222,128,0.15);
  border: 1px solid rgba(74,222,128,0.3);
  border-radius: 50%;
  width: 56px; height: 56px;
  display: flex; align-items: center; justify-content: center;
  color: #4ade80;
}

/* ===== ADMIN PAGE ===== */
.admin-layout {
  display: flex;
  min-height: 100vh;
}

/* Override fixed positioning inside flex admin layout */
.admin-layout .psb-sidebar {
  position: sticky;
  top: 16px;
  left: unset;
  bottom: unset;
  height: calc(100vh - 32px);
  flex-shrink: 0;
  align-self: flex-start;
  margin: 16px 0 16px 16px;
}

.admin-page {
  flex: 1;
  padding: 24px 28px 60px 28px;
  min-width: 0;
  display: flex;
  flex-direction: column;
}

/* ── Sidebar tab switcher (inside psb-sidebar) ── */
.admin-sb-tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  margin: 10px 0 8px;
}
.admin-sb-tab {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 8px;
  color: rgba(255,255,255,0.45);
  font-size: 11px;
  font-weight: 600;
  padding: 5px 10px;
  cursor: pointer;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: background 0.15s, color 0.15s;
}
.admin-sb-tab.active {
  background: rgba(248,113,113,0.18);
  border-color: rgba(248,113,113,0.35);
  color: #f87171;
}

/* ── Equal-width grid tab switcher ── */
.admin-sb-tabs-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 3px;
  margin: 10px 0 8px;
}
.admin-sb-tabs-grid:has(> :nth-child(3):last-child) {
  grid-template-columns: repeat(3, 1fr);
}
.admin-sb-tab-grid {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 7px;
  color: rgba(255,255,255,0.4);
  font-size: 9px;
  font-weight: 700;
  padding: 7px 3px;
  cursor: pointer;
  font-family: inherit;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 2px;
  text-align: center;
  transition: background 0.15s, color 0.15s, border-color 0.15s;
  min-width: 0;
  letter-spacing: 0.2px;
  text-transform: uppercase;
  word-break: break-word;
  hyphens: auto;
}
.admin-sb-tab-grid:hover {
  background: rgba(255,255,255,0.07);
  color: rgba(255,255,255,0.65);
}
.admin-sb-tab-grid.active {
  background: rgba(248,113,113,0.15);
  border-color: rgba(248,113,113,0.4);
  color: #f87171;
}
.admin-sb-tab-label {
  display: block;
  white-space: normal;
  word-break: break-word;
  max-width: 100%;
  line-height: 1.2;
}

/* ── Admin chat panel full-height variant ── */
.admin-chat-panel-full {
  max-height: none !important;
  flex: 1;
  min-height: 0;
  margin-top: 14px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.08);
  display: flex;
  flex-direction: column;
}
.admin-chat-panel-full .admin-chat-messages {
  flex: 1;
  max-height: none;
}

/* ── User profile in admin main panel ── */
.admin-user-profile-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 16px;
  padding-bottom: 16px;
  border-bottom: 1px solid rgba(255,255,255,0.08);
}
.admin-user-avatar {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: rgba(96,165,250,0.2);
  border: 1px solid rgba(96,165,250,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: 800;
  color: #60a5fa;
  flex-shrink: 0;
}
.admin-user-profile-name {
  font-size: 15px;
  font-weight: 700;
  color: white;
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}
.admin-user-profile-meta {
  font-size: 11px;
  color: rgba(255,255,255,0.35);
  margin-top: 2px;
}
.admin-user-badge {
  font-size: 10px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 5px;
}
.admin-user-badge.admin {
  background: rgba(248,113,113,0.15);
  color: #f87171;
  border: 1px solid rgba(248,113,113,0.25);
}
.admin-user-badge.restricted {
  background: rgba(248,113,113,0.1);
  color: #f87171;
}
.admin-user-profile-stats {
  display: flex;
  gap: 16px;
  margin-bottom: 16px;
}
.admin-user-stat {
  display: flex;
  flex-direction: column;
  align-items: center;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 8px;
  padding: 8px 16px;
  gap: 2px;
}
.admin-user-stat-val {
  font-size: 20px;
  font-weight: 800;
  color: white;
}
.admin-user-stat-label {
  font-size: 10px;
  color: rgba(255,255,255,0.4);
  text-transform: uppercase;
  font-weight: 600;
  letter-spacing: 0.5px;
}
.admin-user-villager-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-top: 4px;
}
.admin-user-villager-chip {
  background: rgba(96,165,250,0.1);
  border: 1px solid rgba(96,165,250,0.2);
  border-radius: 5px;
  padding: 2px 8px;
  font-size: 11px;
  color: rgba(255,255,255,0.7);
}
.admin-user-villager-chip.wishlist {
  background: rgba(167,139,250,0.1);
  border-color: rgba(167,139,250,0.2);
}

/* ── Feedback main panel ── */
.admin-feedback-main {
  display: flex;
  flex-direction: column;
  max-width: 680px;
}
.admin-feedback-info-bar {
  display: flex;
  gap: 12px;
  align-items: flex-start;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 10px;
  padding: 14px;
  margin-bottom: 12px;
}
.admin-feedback-info-left {
  flex: 1;
  min-width: 0;
}
.admin-feedback-info-from {
  font-size: 13px;
  font-weight: 700;
  color: white;
  margin-bottom: 2px;
}
.admin-feedback-info-cat {
  font-size: 11px;
  color: rgba(255,255,255,0.4);
  margin-bottom: 6px;
}
.admin-feedback-info-msg {
  font-size: 13px;
  color: rgba(255,255,255,0.75);
  line-height: 1.5;
  white-space: pre-wrap;
  word-break: break-word;
}
.admin-feedback-status-col {
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex-shrink: 0;
}
.admin-feedback-status-btn {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: rgba(255,255,255,0.45);
  font-size: 10px;
  font-weight: 700;
  padding: 5px 10px;
  cursor: pointer;
  font-family: inherit;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  transition: background 0.15s, color 0.15s, border-color 0.15s;
  white-space: nowrap;
}
.admin-feedback-status-btn:hover {
  background: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.7);
}
.admin-feedback-status-btn.active {
  background: rgba(255,255,255,0.07);
  font-weight: 800;
}
.admin-feedback-status-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}
.admin-feedback-anon-reply {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 8px;
}

/* ── Sidebar scrollable list ── */
.admin-sb-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-top: 4px;
  overflow-y: auto;
  flex: 1;
}
.admin-sb-list-mobile {
  max-height: 340px;
  margin-bottom: 16px;
}
.admin-sb-search {
  width: 100%;
  box-sizing: border-box;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  color: white;
  font-size: 12px;
  padding: 6px 10px;
  margin-bottom: 6px;
  font-family: inherit;
  outline: none;
}
.admin-sb-search::placeholder { color: rgba(255,255,255,0.3); }

/* ── Sidebar cards ── */
.admin-sb-card {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 10px;
  padding: 10px 12px;
  cursor: pointer;
  transition: background 0.15s, border-color 0.15s;
}
.admin-sb-card:hover { background: rgba(255,255,255,0.07); }
.admin-sb-card.selected {
  background: rgba(248,113,113,0.1);
  border-color: rgba(248,113,113,0.3);
}
.admin-sb-card.replied { border-left: 3px solid #4ade80; }
.admin-sb-card.unreplied { border-left: 3px solid #f87171; }
.admin-sb-card.restricted { border-left: 3px solid #f87171; }

.admin-sb-card-title {
  font-size: 13px;
  font-weight: 700;
  color: white;
  margin-bottom: 2px;
}
.admin-sb-card-meta {
  font-size: 11px;
  color: rgba(255,255,255,0.4);
  margin-bottom: 2px;
}
.admin-sb-card-sub {
  font-size: 11px;
  color: rgba(255,255,255,0.35);
  font-style: italic;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.admin-sb-empty {
  font-size: 12px;
  color: rgba(255,255,255,0.3);
  padding: 12px 0;
  text-align: center;
}

/* ── Actions inside expanded sidebar card ── */
.admin-sb-actions {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid rgba(255,255,255,0.08);
}

/* ── Main detail panel (desktop: right side; mobile: below list) ── */
.admin-main-detail {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 14px;
  padding: 20px;
  width: 100%;
  display: flex;
  flex-direction: column;
  min-height: calc(100vh - 120px);
}
.admin-main-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  padding: 80px 0;
  color: rgba(255,255,255,0.25);
  font-size: 14px;
}

/* ── Mobile-only action buttons (shown below detail in main) ── */
.admin-mobile-actions {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid rgba(255,255,255,0.08);
}

/* ── Mobile tab strip ── */
.admin-mobile-tabs-wrap {
  padding: 0 16px;
  margin-bottom: 8px;
}
.admin-mobile-tabs-wrap .admin-sb-tabs {
  margin: 0;
  overflow-x: auto;
  flex-wrap: nowrap;
  padding-bottom: 2px;
}

.admin-denied {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 80px 0;
  color: rgba(255,255,255,0.4);
}

.admin-denied-icon { font-size: 48px; }

.admin-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 16px;
  margin-bottom: 24px;
  flex-wrap: wrap;
}

.admin-title {
  font-size: 22px;
  font-weight: 800;
  color: #f87171;
  margin: 0 0 4px;
}

.admin-sub {
  color: rgba(255,255,255,0.35);
  font-size: 12px;
  margin: 0;
}

.admin-stats {
  display: flex;
  gap: 16px;
}

.admin-stat {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 12px;
  padding: 10px 16px;
  min-width: 64px;
}

.admin-stat-val {
  font-size: 22px;
  font-weight: 800;
  color: white;
}

.admin-stat-label {
  font-size: 10px;
  color: rgba(255,255,255,0.35);
  text-transform: uppercase;
  letter-spacing: 0.4px;
}

.admin-tabs {
  display: flex;
  gap: 4px;
  background: rgba(255,255,255,0.04);
  border-radius: 12px;
  padding: 4px;
  margin-bottom: 20px;
  width: fit-content;
}

.admin-tab {
  background: none;
  border: none;
  color: rgba(255,255,255,0.45);
  font-size: 13px;
  font-weight: 600;
  padding: 7px 18px;
  border-radius: 9px;
  cursor: pointer;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: background 0.15s, color 0.15s;
}

.admin-tab.active {
  background: rgba(255,255,255,0.1);
  color: white;
}

.admin-tab-count {
  background: rgba(248,113,113,0.25);
  color: #f87171;
  font-size: 10px;
  font-weight: 700;
  border-radius: 8px;
  padding: 1px 6px;
}

.admin-loading,
.admin-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 60px 0;
  color: rgba(255,255,255,0.3);
  font-size: 14px;
}

.admin-empty-icon { font-size: 32px; }

.admin-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Report card */
.admin-report-card {
  background: rgba(248,113,113,0.05);
  border: 1px solid rgba(248,113,113,0.15);
  border-radius: 16px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.admin-report-header {
  display: flex;
  align-items: center;
  gap: 10px;
}

.admin-report-villager {
  font-size: 16px;
  font-weight: 700;
  color: white;
}

.admin-report-status {
  font-size: 11px;
  color: rgba(255,255,255,0.4);
  background: rgba(255,255,255,0.07);
  border-radius: 6px;
  padding: 2px 8px;
  text-transform: uppercase;
  letter-spacing: 0.4px;
}

.admin-report-parties {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.admin-party {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.admin-party-label {
  font-size: 10px;
  color: rgba(255,255,255,0.3);
  text-transform: uppercase;
  letter-spacing: 0.4px;
}

.admin-party-val {
  font-size: 13px;
  color: rgba(255,255,255,0.75);
  font-weight: 600;
}

.admin-party-sep {
  color: rgba(255,255,255,0.2);
  font-size: 18px;
}

.admin-report-reason {
  background: rgba(255,255,255,0.04);
  border-radius: 10px;
  padding: 10px 12px;
}

.admin-report-reason-label {
  font-size: 10px;
  color: rgba(255,255,255,0.3);
  text-transform: uppercase;
  letter-spacing: 0.4px;
  display: block;
  margin-bottom: 4px;
}

.admin-report-quote {
  margin: 0;
  color: rgba(255,255,255,0.7);
  font-size: 13px;
  font-style: italic;
  border-left: 2px solid rgba(248,113,113,0.4);
  padding-left: 8px;
}

.admin-report-meta {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(248,113,113,0.1);
}

.admin-report-date {
  font-size: 12px;
  color: rgba(255,255,255,0.5);
}

.admin-report-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

/* Admin buttons */
.admin-btn {
  padding: 7px 14px;
  border-radius: 9px;
  border: none;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  font-family: inherit;
  transition: opacity 0.15s, transform 0.1s;
}

.admin-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.admin-btn:not(:disabled):hover { transform: translateY(-1px); }

.admin-btn.dismiss {
  background: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.6);
  border: 1px solid rgba(255,255,255,0.1);
}

.admin-btn.restrict {
  background: rgba(248,113,113,0.15);
  color: #f87171;
  border: 1px solid rgba(248,113,113,0.25);
}

.admin-btn.unrestrict {
  background: rgba(74,222,128,0.15);
  color: #4ade80;
  border: 1px solid rgba(74,222,128,0.25);
}

/* User row */
.admin-user-search {
  width: 100%;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 10px;
  color: white;
  font-size: 13px;
  padding: 9px 14px;
  outline: none;
  font-family: inherit;
  margin-bottom: 14px;
  box-sizing: border-box;
}

.admin-user-search:focus { border-color: rgba(248,113,113,0.4); }

.admin-user-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 12px;
  padding: 12px 14px;
  gap: 12px;
}

.admin-user-row.restricted {
  border-color: rgba(248,113,113,0.2);
  background: rgba(248,113,113,0.04);
}

/* Feedback cards in admin */
.admin-feedback-card {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 16px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.admin-feedback-card.unreplied { border-color: rgba(167,139,250,0.25); background: rgba(167,139,250,0.04); }
.admin-feedback-card.replied   { border-color: rgba(34,197,94,0.2); }

.admin-feedback-header {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.admin-feedback-cat {
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  color: #a78bfa;
  background: rgba(167,139,250,0.1);
  border-radius: 6px;
  padding: 2px 8px;
}
.admin-feedback-user {
  font-size: 12px;
  color: rgba(255,255,255,0.5);
}
.admin-feedback-msg {
  font-size: 14px;
  color: rgba(255,255,255,0.8);
  margin: 0;
  line-height: 1.5;
}
.admin-feedback-reply {
  background: rgba(34,197,94,0.06);
  border: 1px solid rgba(34,197,94,0.15);
  border-radius: 10px;
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.admin-reply-label {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  color: rgba(34,197,94,0.7);
}
.admin-reply-text {
  font-size: 13px;
  color: rgba(255,255,255,0.7);
  margin: 0;
}
.admin-feedback-reply-row {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.admin-reply-input {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 10px;
  color: white;
  font-size: 14px;
  padding: 10px 12px;
  resize: vertical;
  outline: none;
  font-family: inherit;
}
.admin-reply-input:focus { border-color: rgba(167,139,250,0.5); }

.admin-user-info {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  flex: 1;
  min-width: 0;
}

.admin-user-num {
  font-size: 14px;
  font-weight: 700;
  color: white;
}

.admin-user-name {
  font-size: 13px;
  color: rgba(255,255,255,0.6);
}

.admin-user-meta {
  font-size: 11px;
  color: rgba(255,255,255,0.3);
}

.admin-restricted-badge {
  font-size: 10px;
  font-weight: 700;
  color: #f87171;
  background: rgba(248,113,113,0.12);
  border: 1px solid rgba(248,113,113,0.2);
  border-radius: 6px;
  padding: 2px 7px;
}

/* Clickable row highlight */
.admin-report-card.clickable,
.admin-user-row.clickable,
.admin-feedback-card.clickable {
  cursor: pointer;
  transition: background 0.15s, border-color 0.15s;
}
.admin-report-card.clickable:hover   { background: rgba(248,113,113,0.09); }
.admin-feedback-card.clickable:hover { background: rgba(167,139,250,0.08); }
.admin-user-row.clickable:hover      { background: rgba(255,255,255,0.06); }
.admin-report-card.selected   { border-color: rgba(248,113,113,0.5) !important; background: rgba(248,113,113,0.12) !important; }
.admin-feedback-card.selected { border-color: rgba(167,139,250,0.5) !important; background: rgba(167,139,250,0.10) !important; }
.admin-user-row.selected      { border-color: rgba(96,165,250,0.5) !important; background: rgba(96,165,250,0.08) !important; }

/* Admin detail panel (sidebar) */
.admin-detail-panel {
  padding: 8px 0;
  display: flex;
  flex-direction: column;
  gap: 0;
}
.admin-detail-title {
  font-size: 13px;
  font-weight: 700;
  color: rgba(255,255,255,0.7);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 10px;
}
.admin-detail-section {
  margin-bottom: 10px;
}
.admin-detail-label {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: rgba(255,255,255,0.3);
  margin-bottom: 3px;
}
.admin-detail-val {
  font-size: 13px;
  color: rgba(255,255,255,0.75);
  line-height: 1.5;
}
.admin-detail-actions {
  display: flex;
  flex-direction: column;
  gap: 7px;
  margin-top: 12px;
}
.admin-btn.chat-btn {
  background: rgba(96,165,250,0.12);
  color: #60a5fa;
  border: 1px solid rgba(96,165,250,0.2);
}
.admin-btn.chase {
  background: rgba(251,191,36,0.12);
  color: #fbbf24;
  border: 1px solid rgba(251,191,36,0.25);
}
.admin-btn.chase-disabled {
  background: rgba(255,255,255,0.05);
  color: rgba(255,255,255,0.25);
  border: 1px solid rgba(255,255,255,0.07);
}

/* Admin replied badge */
.admin-replied-badge {
  font-size: 10px;
  font-weight: 700;
  color: #4ade80;
  background: rgba(74,222,128,0.1);
  border: 1px solid rgba(74,222,128,0.2);
  border-radius: 6px;
  padding: 2px 8px;
  width: fit-content;
}

/* Admin feedback time */
.admin-feedback-time {
  font-size: 11px;
  color: rgba(255,255,255,0.3);
  margin-left: auto;
}

/* Admin log rows */
.admin-log-row {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  padding: 10px 14px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 10px;
  font-size: 12px;
}
.admin-log-action {
  font-weight: 700;
  color: rgba(255,255,255,0.8);
  font-family: monospace;
  font-size: 11px;
  background: rgba(255,255,255,0.07);
  padding: 2px 7px;
  border-radius: 5px;
}
.admin-log-who { color: rgba(255,255,255,0.4); }
.admin-log-note { color: rgba(255,255,255,0.55); flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.admin-log-time { color: rgba(255,255,255,0.25); font-size: 11px; margin-left: auto; }

/* Admin empty hint */
.admin-empty-hint {
  font-size: 12px;
  color: rgba(255,255,255,0.25);
  text-align: center;
  margin-top: 4px;
}

/* Admin chat panel (in sidebar / main area) */
.admin-chat-panel {
  display: flex;
  flex-direction: column;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 14px;
  margin-top: 12px;
  overflow: hidden;
  max-height: 320px;
}
.admin-chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px 8px;
  font-size: 12px;
  font-weight: 700;
  color: rgba(255,255,255,0.6);
  border-bottom: 1px solid rgba(255,255,255,0.07);
}
.admin-chat-close {
  background: none; border: none; cursor: pointer;
  color: rgba(255,255,255,0.4); font-size: 14px; padding: 0;
}
.admin-chat-messages {
  flex: 1;
  overflow-y: auto;
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  scrollbar-width: none;
}
.admin-chat-messages::-webkit-scrollbar { display: none; }
.admin-chat-bubble {
  max-width: 80%;
  border-radius: 12px;
  padding: 7px 12px;
}
.admin-chat-bubble.mine {
  align-self: flex-end;
  background: rgba(96,165,250,0.18);
  color: rgba(255,255,255,0.9);
}
.admin-chat-bubble.theirs {
  align-self: flex-start;
  background: rgba(255,255,255,0.07);
  color: rgba(255,255,255,0.8);
}
.admin-chat-text { font-size: 13px; line-height: 1.4; }
.admin-chat-time { font-size: 10px; color: rgba(255,255,255,0.3); margin-top: 2px; }
.admin-chat-input-row {
  display: flex;
  gap: 6px;
  padding: 8px 10px;
  border-top: 1px solid rgba(255,255,255,0.07);
}
.admin-chat-input {
  flex: 1;
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 10px;
  color: white;
  padding: 7px 12px;
  font-size: 13px;
  outline: none;
  font-family: inherit;
}
.admin-chat-send {
  background: rgba(96,165,250,0.2);
  border: 1px solid rgba(96,165,250,0.3);
  color: #60a5fa;
  border-radius: 10px;
  padding: 7px 14px;
  cursor: pointer;
  font-size: 14px;
}
.admin-chat-send:disabled { opacity: 0.3; cursor: not-allowed; }

/* fb-sidebar-inner (scrollable area above nav) */
.fb-sidebar-inner {
  flex: 1;
  overflow-y: auto;
  padding: 16px 16px 8px;
  scrollbar-width: none;
}
.fb-sidebar-inner::-webkit-scrollbar { display: none; }

/* Profile page trade request button on villager cards */
.pro-card-trade-btn {
  margin-top: 6px;
  background: rgba(96,165,250,0.14);
  border: 1px solid rgba(96,165,250,0.25);
  color: #60a5fa;
  border-radius: 8px;
  padding: 4px 10px;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: opacity 0.15s, background 0.15s;
  width: 100%;
}
.pro-card-trade-btn:hover:not(:disabled) { background: rgba(96,165,250,0.22); }
.pro-card-trade-btn.sent {
  background: rgba(74,222,128,0.12);
  border-color: rgba(74,222,128,0.22);
  color: #4ade80;
  cursor: default;
}
.pro-card-trade-btn:disabled { opacity: 0.5; cursor: not-allowed; }

/* Trade hint text above grid when viewing other user */
.pro-trade-hint {
  font-size: 12px;
  color: rgba(255,255,255,0.35);
  margin: -8px 0 12px;
  line-height: 1.5;
}

/* ===== AUTH GATE MODAL ===== */
.authgate-overlay {
  position: fixed;
  inset: 0;
  z-index: 2000;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
}
.authgate-modal {
  background: linear-gradient(160deg, rgba(14,28,12,0.72) 0%, rgba(8,18,8,0.68) 100%);
  backdrop-filter: blur(48px) saturate(180%);
  -webkit-backdrop-filter: blur(48px) saturate(180%);
  border: 1px solid rgba(255,255,255,0.14);
  border-top: 1px solid rgba(255,255,255,0.22);
  border-radius: 24px;
  padding: 32px 28px 28px;
  max-width: 360px;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: 0;
  box-shadow: 0 24px 80px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.1);
}
.authgate-icon {
  font-size: 40px;
  margin-bottom: 14px;
}
.authgate-title {
  font-size: 20px;
  font-weight: 800;
  color: white;
  margin: 0 0 8px;
}
.authgate-sub {
  font-size: 14px;
  color: rgba(255,255,255,0.55);
  margin: 0;
  line-height: 1.5;
}
.authgate-actions {
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
  margin-top: 24px;
}
.authgate-btn {
  width: 100%;
  padding: 13px 20px;
  border-radius: 14px;
  border: none;
  font-size: 15px;
  font-weight: 700;
  cursor: pointer;
  transition: opacity 0.15s, transform 0.1s;
  font-family: inherit;
}
.authgate-btn:hover { opacity: 0.9; transform: translateY(-1px); }
.authgate-btn.primary {
  background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
  color: white;
  box-shadow: 0 4px 20px rgba(34,197,94,0.35);
}
.authgate-btn.secondary {
  background: rgba(255,255,255,0.07);
  color: rgba(255,255,255,0.5);
  border: 1px solid rgba(255,255,255,0.1);
}

/* ===== TUTORIAL OVERLAY ===== */
.tutorial-overlay {
  position: fixed;
  inset: 0;
  z-index: 3000;
  pointer-events: none;
}
.tutorial-backdrop {
  position: absolute;
  inset: 0;
  background: transparent;
  pointer-events: all;
}
.tutorial-highlight {
  position: absolute;
  border-radius: 12px;
  border: 2px solid rgba(251,146,60,0.95);
  /* Giant box-shadow darkens everything OUTSIDE the highlight rect */
  box-shadow:
    0 0 0 9999px rgba(0,0,0,0.55),
    0 0 0 4px rgba(251,146,60,0.2),
    0 0 24px 6px rgba(251,146,60,0.4);
  pointer-events: none;
  transition: top 0.3s cubic-bezier(0.22,1,0.36,1),
              left 0.3s cubic-bezier(0.22,1,0.36,1),
              width 0.3s cubic-bezier(0.22,1,0.36,1),
              height 0.3s cubic-bezier(0.22,1,0.36,1);
  z-index: 1;
  animation: tutorial-glow-pulse 1.8s ease-in-out infinite;
}
@keyframes tutorial-glow-pulse {
  0%, 100% { box-shadow: 0 0 0 9999px rgba(0,0,0,0.55), 0 0 0 4px rgba(251,146,60,0.2), 0 0 24px 6px rgba(251,146,60,0.4); }
  50%       { box-shadow: 0 0 0 9999px rgba(0,0,0,0.55), 0 0 0 6px rgba(251,146,60,0.15), 0 0 36px 10px rgba(251,146,60,0.55); }
}
.tutorial-tooltip {
  position: absolute;
  background: linear-gradient(160deg, rgba(14,28,12,0.90) 0%, rgba(8,18,8,0.88) 100%);
  backdrop-filter: blur(32px) saturate(180%);
  -webkit-backdrop-filter: blur(32px) saturate(180%);
  border: 1px solid rgba(255,255,255,0.16);
  border-top: 1px solid rgba(255,255,255,0.24);
  border-radius: 20px;
  padding: 18px 20px 16px;
  max-width: 280px;
  min-width: 220px;
  box-shadow: 0 16px 56px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.09);
  pointer-events: all;
  z-index: 2;
}
.tutorial-step-badge {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.6px;
  color: #ffd700;
  margin-bottom: 6px;
}
.tutorial-tooltip-title {
  font-size: 15px;
  font-weight: 800;
  color: white;
  margin: 0 0 6px;
}
.tutorial-tooltip-body {
  font-size: 13px;
  color: rgba(255,255,255,0.65);
  line-height: 1.5;
  margin: 0;
}
.tutorial-hint {
  font-size: 11px;
  color: rgba(255,255,255,0.3);
  margin: 6px 0 0;
  font-style: italic;
}
.tutorial-tooltip-actions {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 14px;
  gap: 8px;
}
.tutorial-btn {
  padding: 8px 16px;
  border-radius: 10px;
  border: none;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  font-family: inherit;
  transition: opacity 0.15s;
}
.tutorial-btn:hover { opacity: 0.85; }
.tutorial-btn.next {
  background: linear-gradient(135deg, #ffd700 0%, #b8860b 100%);
  color: #1a1000;
  flex: 1;
}
.tutorial-btn.skip {
  background: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.45);
  border: 1px solid rgba(255,255,255,0.1);
}
.tutorial-progress {
  display: flex;
  gap: 4px;
  align-items: center;
  justify-content: center;
  margin-top: 10px;
}
.tutorial-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: rgba(255,255,255,0.2);
  transition: background 0.2s;
}
.tutorial-dot.active { background: #ffd700; }

/* Gold user ID pill — hidden on desktop, shown only on mobile via media query */
.mobile-user-pill { display: none; }

/* Tutorial ? button — overlaid top-right of logo, no border, no circle */
.sidebar-logo-header { position: relative; }
.tutorial-trigger-btn {
  position: absolute;
  top: -2px;
  right: -2px;
  background: none;
  border: none;
  color: rgba(255,215,0,0.55);
  font-size: 13px;
  font-weight: 800;
  cursor: pointer;
  padding: 2px 4px;
  line-height: 1;
  transition: color 0.15s;
}
.tutorial-trigger-btn:hover { color: #ffd700; }

/* Responsive sidebar collapse on mobile */
@media (max-width: 768px) {
  .sidebar.open {
    width: 100%;
  }

  .main-content.with-sidebar {
    margin-left: 0;
    padding-top: 60px;
  }

  .sidebar {
    height: auto;
    bottom: 0;
  }

  .owned-grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

/* Legacy styles for compatibility */
.App {
  text-align: center;
}

.App-logo {
  height: 40vmin;
  pointer-events: none;
}

@media (prefers-reduced-motion: no-preference) {
  .App-logo {
    animation: App-logo-spin infinite 20s linear;
  }
}

.App-header {
  background-color: #282c34;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: calc(10px + 2vmin);
  color: white;
}

.App-link {
  color: #61dafb;
}

@keyframes App-logo-spin {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}

/* ===== LAYOUT WRAPPERS — sidebars are fixed, main pages get right padding ===== */
.profile-layout,
.trades-layout,
.feedback-layout {
  display: block;
}

/* Hide web sidebar on mobile for all pages */
@media (max-width: 768px) {
  .psb-sidebar,
  .tsb-sidebar {
    display: none !important;
  }
  
  .feedback-layout {
    padding: 0 !important;
  }
  
  .feedback-page {
    margin: 0 !important;
    padding: 16px !important;
    max-width: 100% !important;
  }
}

/* Left-sidebar padding is baked directly into .profile-page and .trades-page */

/* ===== PROFILE SIDEBAR — fixed left panel, matches shop sidebar style ===== */
.psb-sidebar {
  position: fixed;
  top: 16px;
  left: 16px;
  bottom: 16px;
  width: 270px;
  z-index: 100;
  border-radius: 20px;
  display: flex;
  flex-direction: column;
  background: linear-gradient(160deg, rgba(12,24,10,0.55) 0%, rgba(8,16,8,0.48) 100%);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border: 1px solid rgba(255,255,255,0.10);
  border-top: 1px solid rgba(255,255,255,0.18);
  border-left: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 8px 48px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
  overflow: hidden;
  padding: 0;
}

/* Scrollable inner area for profile sidebar */
.psb-sidebar-inner {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow-y: auto;
  scrollbar-width: none;
  padding: 20px 14px 14px;
  min-height: 0;
}
.psb-sidebar-inner::-webkit-scrollbar { display: none; }

.psb-tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 16px;
}

.psb-tab {
  flex: 1;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 8px;
  color: rgba(255,255,255,0.45);
  font-size: 11px;
  font-weight: 600;
  padding: 6px 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
}
.psb-tab.active {
  background: rgba(255,255,255,0.09);
  border-color: rgba(255,255,255,0.15);
  color: white;
}
.psb-tab-badge {
  background: #ef4444;
  color: white;
  font-size: 9px;
  font-weight: 700;
  border-radius: 10px;
  padding: 1px 5px;
}

/* Online dot */
.psb-online-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}
.psb-online-dot.online  { background: #4ade80; box-shadow: 0 0 5px #4ade80; }
.psb-online-dot.offline { background: #f87171; box-shadow: 0 0 4px rgba(248,113,113,0.5); }

/* Search panel */
.psb-search-input,
.tsb-villager-input {
  width: 100%;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  color: white;
  font-size: 12px;
  padding: 7px 10px;
  outline: none;
  box-sizing: border-box;
  margin-bottom: 8px;
}
.psb-search-input::placeholder,
.tsb-villager-input::placeholder { color: rgba(255,255,255,0.3); }

.psb-results, .psb-friends-panel { display: flex; flex-direction: column; gap: 4px; }

.psb-result-row, .psb-friend-row {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: 10px;
  cursor: pointer;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.06);
  transition: background 0.12s;
}
.psb-result-row:hover, .psb-friend-row:hover { background: rgba(255,255,255,0.07); }
.psb-result-info { display: flex; flex-direction: column; flex: 1; min-width: 0; }
.psb-result-name { color: white; font-size: 12px; font-weight: 600; }
.psb-result-meta { color: rgba(255,255,255,0.35); font-size: 10px; }
.psb-result-arrow { color: rgba(255,255,255,0.25); font-size: 14px; }
.psb-no-results  { color: rgba(255,255,255,0.25); font-size: 11px; text-align: center; padding: 16px 0; }
.psb-loading     { color: rgba(255,255,255,0.3); font-size: 11px; padding: 8px 0; }

/* Friend actions */
.psb-user-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 8px;
}
.psb-action-btn {
  border-radius: 7px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.05);
  color: rgba(255,255,255,0.7);
  font-size: 11px;
  font-weight: 600;
  padding: 5px 10px;
  cursor: pointer;
  white-space: nowrap;
}
.psb-action-btn.add   { border-color: rgba(74,222,128,0.4); color: #4ade80; background: rgba(74,222,128,0.07); }
.psb-action-btn.chat  { border-color: rgba(96,165,250,0.4); color: #60a5fa; background: rgba(96,165,250,0.07); }
.psb-unread-badge {
  position: absolute;
  top: -6px;
  right: -6px;
  background: #f87171;
  color: white;
  font-size: 9px;
  font-weight: 700;
  border-radius: 10px;
  padding: 1px 4px;
  min-width: 14px;
  text-align: center;
  line-height: 14px;
  pointer-events: none;
}
.psb-unread-row {
  border-color: rgba(248,113,113,0.25) !important;
  background: rgba(248,113,113,0.06) !important;
}
.psb-unread-row:hover { background: rgba(248,113,113,0.12) !important; }

.psb-action-btn.block { border-color: rgba(239,68,68,0.3); color: #f87171; background: rgba(239,68,68,0.06); }
.psb-action-btn.unblock { border-color: rgba(251,191,36,0.4); color: #fbbf24; background: rgba(251,191,36,0.07); }
.psb-action-btn.report { border-color: rgba(239,68,68,0.2); color: rgba(239,68,68,0.6); background: none; font-size: 10px; }
.psb-action-pending { color: rgba(255,255,255,0.3); font-size: 11px; }
.psb-report-row { display: flex; gap: 4px; width: 100%; }
.psb-report-input {
  flex: 1;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: white;
  font-size: 11px;
  padding: 4px 8px;
  outline: none;
}

/* User profile view */
.psb-user-profile { display: flex; flex-direction: column; gap: 12px; }
.psb-user-profile-header { display: flex; flex-direction: column; gap: 8px; }
.psb-back-btn {
  background: none;
  border: none;
  color: rgba(255,255,255,0.4);
  font-size: 12px;
  cursor: pointer;
  text-align: left;
  padding: 0;
}
.psb-back-btn:hover { color: white; }
.psb-profile-identity { display: flex; align-items: center; gap: 6px; }
.psb-profile-name { color: white; font-size: 16px; font-weight: 700; }
.psb-profile-num  { color: rgba(255,255,255,0.35); font-size: 11px; }

.psb-profile-section { display: flex; flex-direction: column; gap: 6px; }
.psb-profile-section-title { color: rgba(255,255,255,0.4); font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
.psb-profile-grid { display: flex; flex-wrap: wrap; gap: 6px; }
.psb-profile-card {
  display: flex; flex-direction: column; align-items: center; gap: 3px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 10px;
  padding: 6px 8px;
  width: 54px;
}
.psb-card-icon {
  width: 28px; height: 28px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px;
}
.psb-card-name { color: rgba(255,255,255,0.6); font-size: 8px; font-weight: 600; text-align: center; max-width: 50px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.psb-empty-note { color: rgba(255,255,255,0.2); font-size: 11px; }

/* Friends section */
.psb-friends-section { display: flex; flex-direction: column; gap: 4px; margin-bottom: 12px; }
.psb-section-label { color: rgba(255,255,255,0.3); font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; }

/* Leaderboard */
.psb-leaderboard-panel { display: flex; flex-direction: column; gap: 8px; }
.psb-lb-tabs { display: flex; gap: 4px; }
.psb-lb-tab {
  flex: 1; padding: 5px; border-radius: 7px;
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(255,255,255,0.04);
  color: rgba(255,255,255,0.4);
  font-size: 11px; font-weight: 600; cursor: pointer;
}
.psb-lb-tab.active { background: rgba(255,255,255,0.09); border-color: rgba(255,255,255,0.15); color: white; }
.psb-lb-list { display: flex; flex-direction: column; gap: 3px; }
.psb-lb-row {
  display: flex; align-items: center; gap: 8px;
  padding: 6px 8px; border-radius: 8px;
  background: rgba(255,255,255,0.03);
}
.psb-lb-rank { color: rgba(255,255,255,0.25); font-size: 11px; font-weight: 700; width: 16px; text-align: center; }
.psb-lb-rank.top { color: #fbbf24; }
.psb-lb-name { flex: 1; color: rgba(255,255,255,0.75); font-size: 11px; font-weight: 600; }
.psb-lb-count { color: rgba(255,255,255,0.35); font-size: 11px; }
.psb-lb-legend { color: rgba(255,255,255,0.2); font-size: 9px; text-align: center; margin-top: 4px; }

/* Leaderboard podium (top 3) */
.psb-lb-podium {
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 6px;
  margin-bottom: 10px;
}
.psb-lb-podium-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  border-radius: 12px;
  padding: 8px 6px 6px;
  border: 1px solid rgba(255,255,255,0.08);
  min-width: 60px;
  flex: 1;
}
.psb-lb-podium-card.rank-1 {
  background: rgba(251,191,36,0.12);
  border-color: rgba(251,191,36,0.3);
  padding-top: 14px;
}
.psb-lb-podium-card.rank-2 {
  background: rgba(156,163,175,0.1);
  border-color: rgba(156,163,175,0.25);
}
.psb-lb-podium-card.rank-3 {
  background: rgba(180,120,60,0.1);
  border-color: rgba(180,120,60,0.25);
}
.psb-lb-podium-medal {
  font-size: 16px;
  line-height: 1;
}
.psb-lb-podium-name {
  color: white;
  font-size: 9px;
  font-weight: 700;
  text-align: center;
  max-width: 58px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.psb-lb-podium-count {
  font-size: 11px;
  font-weight: 800;
}
.psb-lb-podium-card.rank-1 .psb-lb-podium-count { color: #fbbf24; }
.psb-lb-podium-card.rank-2 .psb-lb-podium-count { color: #9ca3af; }
.psb-lb-podium-card.rank-3 .psb-lb-podium-count { color: #b47840; }
.psb-lb-rest { display: flex; flex-direction: column; gap: 2px; }

/* ===== TRADES SIDEBAR — fixed left panel, matches shop sidebar style ===== */
.tsb-sidebar {
  position: fixed;
  top: 16px;
  left: 16px;
  bottom: 16px;
  width: 270px;
  z-index: 100;
  border-radius: 20px;
  display: flex;
  flex-direction: column;
  background: linear-gradient(160deg, rgba(12,24,10,0.55) 0%, rgba(8,16,8,0.48) 100%);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border: 1px solid rgba(255,255,255,0.10);
  border-top: 1px solid rgba(255,255,255,0.18);
  border-left: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 8px 48px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
  overflow: hidden;
  padding: 0;
}

/* Scrollable inner — mirrors psb-sidebar-inner */
.tsb-sidebar-inner {
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  scrollbar-width: none;
  padding: 20px 14px 8px;
  min-height: 0;
  max-height: calc(100% - 120px); /* leave room for nav footer */
}
.tsb-sidebar-inner::-webkit-scrollbar { display: none; }
.tsb-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}
.tsb-title { color: rgba(255,255,255,0.5); font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
.tsb-reset { background: none; border: none; color: rgba(239,68,68,0.6); font-size: 10px; cursor: pointer; padding: 0; }
.tsb-reset:hover { color: #f87171; }

.tsb-section { display: flex; flex-direction: column; gap: 6px; margin-bottom: 16px; }
.tsb-section-label { color: rgba(255,255,255,0.3); font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.4px; }

.tsb-filter-pill {
  display: inline-flex;
  align-items: center;
  padding: 5px 10px;
  border-radius: 20px;
  border: 1px solid rgba(255,255,255,0.1);
  background: rgba(255,255,255,0.04);
  color: rgba(255,255,255,0.5);
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  text-align: left;
  width: fit-content;
  transition: all 0.12s;
}
.tsb-filter-pill:hover { background: rgba(255,255,255,0.08); color: white; }
.tsb-filter-pill.active { background: rgba(167,139,250,0.15); border-color: rgba(167,139,250,0.4); color: #c4b5fd; }
.tsb-filter-pill.small { font-size: 10px; padding: 3px 8px; }

.tsb-villager-pills { display: flex; flex-wrap: wrap; gap: 4px; }
.tsb-summary { color: rgba(255,255,255,0.2); font-size: 10px; margin-top: auto; padding-top: 12px; }

/* ===== CHAT MODAL ===== */
.chat-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(4px);
  z-index: 200;
  display: flex;
  align-items: center;
  justify-content: center;
}
.chat-modal {
  width: 420px;
  max-width: 95vw;
  height: 600px;
  max-height: 90vh;
  background: #1a1f1a;
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
.chat-modal.chat-modal-inline {
  width: 100%;
  max-width: 100%;
  flex: 1;
  min-height: 0;
  height: auto;
  max-height: none;
  border-radius: 16px;
  background: rgba(255,255,255,0.03);
  border-color: rgba(255,255,255,0.08);
}

/* Chat header */
.chat-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 14px 16px;
  border-bottom: 1px solid rgba(255,255,255,0.07);
  flex-shrink: 0;
}
.chat-close { background: none; border: none; color: rgba(255,255,255,0.4); font-size: 16px; cursor: pointer; padding: 0 4px; }
.chat-close:hover { color: white; }
.chat-header-info { display: flex; align-items: center; gap: 7px; flex: 1; min-width: 0; }
.chat-header-name { color: white; font-size: 14px; font-weight: 700; }
.chat-header-status { color: rgba(255,255,255,0.3); font-size: 11px; }
.chat-actions-btn { background: none; border: none; color: rgba(255,255,255,0.4); font-size: 18px; cursor: pointer; padding: 0 4px; letter-spacing: 1px; }
.chat-actions-btn:hover { color: white; }

/* Actions dropdown */
.chat-actions-menu {
  background: rgba(255,255,255,0.05);
  border-bottom: 1px solid rgba(255,255,255,0.07);
  padding: 10px 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  flex-shrink: 0;
}
.chat-action-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: rgba(255,255,255,0.6); background: none; border: none; cursor: pointer; padding: 4px 0; text-align: left; }
.chat-action-item:hover { color: white; }
.chat-action-item.report-row { flex-wrap: wrap; gap: 6px; cursor: default; }
.chat-report-input {
  flex: 1; min-width: 120px;
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: white;
  font-size: 11px;
  padding: 4px 8px;
  outline: none;
}
.chat-action-btn-sm {
  background: rgba(239,68,68,0.1);
  border: 1px solid rgba(239,68,68,0.3);
  border-radius: 6px;
  color: #f87171;
  font-size: 11px;
  font-weight: 600;
  padding: 4px 8px;
  cursor: pointer;
}
.chat-action-btn-sm:disabled { opacity: 0.4; cursor: not-allowed; }

/* Messages area */
.chat-messages {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,0.1) transparent;
}
.chat-bubble-wrap { display: flex; flex-direction: column; }
.chat-bubble-wrap.mine  { align-items: flex-end; }
.chat-bubble-wrap.theirs { align-items: flex-start; }

.chat-bubble {
  max-width: 72%;
  padding: 8px 12px;
  border-radius: 14px;
  font-size: 13px;
  line-height: 1.4;
  word-break: break-word;
}
.chat-bubble-wrap.mine   .chat-bubble { background: rgba(167,139,250,0.2); border: 1px solid rgba(167,139,250,0.3); color: white; border-bottom-right-radius: 4px; }
.chat-bubble-wrap.theirs .chat-bubble { background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.9); border-bottom-left-radius: 4px; }

.chat-meta { display: flex; align-items: center; gap: 4px; margin-top: 2px; }
.chat-read-tick { color: #60a5fa; font-size: 11px; }
.chat-sent-tick  { color: rgba(255,255,255,0.25); font-size: 11px; }
.chat-bubble-wrap .chat-meta { color: rgba(255,255,255,0.25); font-size: 10px; }

/* Typing indicator */
.typing-indicator {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 10px 14px;
  width: 52px;
}
.typing-indicator span {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: rgba(255,255,255,0.35);
  animation: typing-bounce 1.2s ease-in-out infinite;
}
.typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
.typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
@keyframes typing-bounce {
  0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
  30%            { transform: translateY(-5px); opacity: 1; }
}

/* Report bubble */
.chat-report-bubble {
  display: flex;
  gap: 4px;
  margin-top: 4px;
  align-items: center;
}

/* Typing indicator label */
.chat-typing-label {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 16px 2px;
  font-size: 11px;
  color: rgba(255,255,255,0.45);
  font-style: italic;
  flex-shrink: 0;
}
.chat-typing-dots {
  display: inline-flex;
  gap: 3px;
  align-items: center;
}
.chat-typing-dots span {
  width: 4px; height: 4px;
  border-radius: 50%;
  background: rgba(167,139,250,0.7);
  display: inline-block;
  animation: typingBounce 1.2s infinite;
}
.chat-typing-dots span:nth-child(2) { animation-delay: 0.2s; }
.chat-typing-dots span:nth-child(3) { animation-delay: 0.4s; }
@keyframes typingBounce {
  0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
  30% { transform: translateY(-4px); opacity: 1; }
}

/* Input row */
.chat-input-row {
  display: flex;
  gap: 8px;
  padding: 12px 16px;
  border-top: 1px solid rgba(255,255,255,0.07);
  flex-shrink: 0;
}
.chat-input {
  flex: 1;
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 10px;
  color: white;
  font-size: 13px;
  padding: 8px 12px;
  outline: none;
  resize: none;
}
.chat-input:focus { border-color: rgba(167,139,250,0.4); }
.chat-send-btn {
  width: 36px; height: 36px;
  border-radius: 10px;
  border: none;
  background: rgba(167,139,250,0.25);
  color: #c4b5fd;
  font-size: 16px;
  cursor: pointer;
  align-self: flex-end;
  flex-shrink: 0;
  transition: background 0.15s;
}
.chat-send-btn:hover:not(:disabled) { background: rgba(167,139,250,0.4); }
.chat-send-btn:disabled { opacity: 0.35; cursor: not-allowed; }

/* ===== MOBILE NAV (MobileNav.tsx) — hidden on desktop ===== */
.mobnav-pill-wrap    { display: none; }
.mobnav-backdrop     { display: none; }
.mobnav-dropdown     { display: none; }

/* ===== MOBILE — hidden on desktop ===== */
.psb-mobile-bar      { display: none; }
.psb-mobile-backdrop { display: none; }
.psb-sidebar-close   { display: none; }
.tsb-sidebar-close   { display: none; }
.mobile-search-bar   { display: none; }
.sidebar-mobile-tab  { display: none; }

@media (max-width: 768px) {

  /* ── MobileNav pill + dropdown ── */
  .mobnav-pill-wrap {
    display: flex !important;
    position: fixed !important;
    top: 12px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    z-index: 700 !important;
  }
  .mobnav-pill {
    display: flex;
    align-items: center;
    gap: 8px;
    background: linear-gradient(135deg, rgba(12,24,10,0.78) 0%, rgba(8,16,8,0.72) 100%);
    backdrop-filter: blur(32px) saturate(200%);
    -webkit-backdrop-filter: blur(32px) saturate(200%);
    border: 1px solid rgba(255,255,255,0.18);
    border-top: 1px solid rgba(255,255,255,0.28);
    border-radius: 40px;
    padding: 9px 18px;
    color: white;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 4px 24px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.12);
    white-space: nowrap;
  }
  .mobnav-filter-badge {
    background: #a78bfa;
    color: #0d1a0b;
    font-size: 10px;
    font-weight: 800;
    border-radius: 20px;
    padding: 1px 6px;
    line-height: 1.4;
  }
  .mobnav-pill-arrow {
    font-size: 10px;
    opacity: 0.6;
  }

  /* MobileNav logo header */
  .mobnav-logo-header {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 0 14px;
    border-bottom: 1px solid rgba(255,255,255,0.07);
    margin-bottom: 4px;
  }
  .mobnav-logo-img {
    width: 90px;
    height: auto;
    object-fit: contain;
    opacity: 0.90;
    filter: drop-shadow(0 2px 8px rgba(0,0,0,0.4));
  }

  .mobnav-backdrop {
    display: block !important;
    position: fixed !important;
    inset: 0 !important;
    background: rgba(0,0,0,0.55) !important;
    z-index: 695 !important;
  }
  .mobnav-drawer {
    display: flex !important;
    flex-direction: column !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: auto !important;
    max-height: 90vh !important;
    background: linear-gradient(160deg, #0f1108 0%, #181a06 40%, #12140a 100%) !important;
    backdrop-filter: blur(20px) !important;
    border-bottom-left-radius: 24px !important;
    border-bottom-right-radius: 24px !important;
    z-index: 695 !important;
    animation: slideDown 0.3s ease-out !important;
  }

  @keyframes slideDown {
    from {
      transform: translateY(-100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  .mobnav-drawer {
    border-radius: 0 0 28px 28px !important;
    z-index: 696 !important;
    overflow-y: visible !important;
    padding: 52px 20px 24px !important;
    box-shadow: 0 12px 60px rgba(0,0,0,0.65), inset 0 -1px 0 rgba(255,255,255,0.07) !important;
  }

  /* Drawer handle and close button */
  .mobnav-drawer-handle {
    display: flex !important;
    justify-content: center !important;
    padding: 16px 0 8px 0 !important;
    margin-top: auto !important;
  }

  .mobnav-close-btn {
    padding: 8px 20px !important;
    background: rgba(255,255,255,0.1) !important;
    border: 1px solid rgba(255,255,255,0.2) !important;
    border-radius: 12px !important;
    color: rgba(255,255,255,0.7) !important;
    font-size: 14px !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
  }

  .mobnav-close-btn:hover {
    background: rgba(255,255,255,0.15) !important;
    color: white !important;
  }

  /* Hide web sidebar on mobile, show mobile nav only on mobile */
  .web-sidebar-only {
    display: none !important;
  }

  .mobile-nav-only {
    display: block !important;
  }

  /* Mobile Search Bar */
  .mobile-search-bar {
    display: none !important;
    align-items: center !important;
    gap: 8px !important;
    padding: 12px 16px !important;
    background: rgba(255,255,255,0.08) !important;
    border: 1px solid rgba(255,255,255,0.12) !important;
    border-radius: 12px !important;
    margin-bottom: 16px !important;
  }

  .mobile-search-input {
    flex: 1 !important;
    background: none !important;
    border: none !important;
    color: white !important;
    font-size: 16px !important;
    outline: none !important;
  }

  .mobile-search-input::placeholder {
    color: rgba(255,255,255,0.4) !important;
  }

  .mobile-search-clear {
    background: none !important;
    border: none !important;
    color: rgba(255,255,255,0.5) !important;
    font-size: 16px !important;
    cursor: pointer !important;
    padding: 4px !important;
  }

  /* Show mobile search bar only on mobile */
  .mobile-search-bar {
    display: flex !important;
  }

  /* Mobile Filters in drawer */
  .mobnav-filters {
    display: flex !important;
    flex-direction: column !important;
    gap: 16px !important;
    padding: 16px 0 !important;
    border-top: 1px solid rgba(255,255,255,0.08) !important;
    margin-top: 16px !important;
  }

  .mobnav-filter-section {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  .mobnav-filter-label {
    color: rgba(255,255,255,0.7) !important;
    font-size: 14px !important;
    font-weight: 500 !important;
  }

  .mobnav-filter-chips {
    display: flex !important;
    gap: 8px !important;
    flex-wrap: wrap !important;
  }

  .mobnav-filter-chip {
    padding: 6px 12px !important;
    background: rgba(255,255,255,0.08) !important;
    border: 1px solid rgba(255,255,255,0.12) !important;
    border-radius: 8px !important;
    color: rgba(255,255,255,0.7) !important;
    font-size: 14px !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
  }

  .mobnav-filter-chip.active {
    background: rgba(167,139,250,0.2) !important;
    border-color: rgba(167,139,250,0.4) !important;
    color: #c4b5fd !important;
  }

  .mobnav-clear-filters {
    padding: 8px 16px !important;
    background: rgba(239,68,68,0.2) !important;
    border: 1px solid rgba(239,68,68,0.3) !important;
    border-radius: 8px !important;
    color: #f87171 !important;
    font-size: 14px !important;
    cursor: pointer !important;
    align-self: flex-start !important;
  }

  /* Page title and extra content */
  .mobnav-page-title {
    display: none !important;
  }

  .mobnav-page-title h2 {
    display: none !important;
    color: white !important;
    font-size: 20px !important;
    font-weight: 600 !important;
    margin: 0 !important;
    text-align: center !important;
  }

  .mobnav-extra-content {
    display: flex !important;
    flex-direction: column !important;
    gap: 20px !important;
    padding: 16px 0 !important;
    border-top: 1px solid rgba(255,255,255,0.08) !important;
    margin-top: 16px !important;
  }

  .mobnav-section {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
  }

  .mobnav-section-label {
    color: rgba(255,255,255,0.7) !important;
    font-size: 14px !important;
    font-weight: 500 !important;
  }

  /* Ranks and friends */
  .mobnav-rank-info {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
  }

  .mobnav-rank-badge {
    padding: 4px 8px !important;
    background: rgba(251,191,36,0.2) !important;
    border: 1px solid rgba(251,191,36,0.3) !important;
    border-radius: 6px !important;
    color: #fbbf24 !important;
    font-size: 12px !important;
    font-weight: 500 !important;
  }

  .mobnav-rank-details {
    color: rgba(255,255,255,0.6) !important;
    font-size: 14px !important;
  }

  .mobnav-friends-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  .mobnav-friend-item {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    padding: 8px 0 !important;
  }

  .mobnav-friend-avatar {
    width: 24px !important;
    height: 24px !important;
    background: rgba(255,255,255,0.1) !important;
    border-radius: 50% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 12px !important;
  }

  .mobnav-friend-name {
    flex: 1 !important;
    color: rgba(255,255,255,0.8) !important;
    font-size: 14px !important;
  }

  .mobnav-friend-status.online {
    color: #10b981 !important;
  }

  .mobnav-friend-status.offline {
    color: #6b7280 !important;
  }

  /* Feedback cards */
  .mobnav-feedback-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  .mobnav-feedback-item {
    padding: 12px !important;
    background: rgba(255,255,255,0.05) !important;
    border: 1px solid rgba(255,255,255,0.08) !important;
    border-radius: 8px !important;
  }

  .mobnav-feedback-category {
    color: rgba(167,139,250,0.8) !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    margin-bottom: 4px !important;
  }

  .mobnav-feedback-preview {
    color: rgba(255,255,255,0.7) !important;
    font-size: 14px !important;
    margin-bottom: 8px !important;
  }

  .mobnav-feedback-status {
    color: rgba(255,255,255,0.5) !important;
    font-size: 12px !important;
  }

  /* Horizontal Villager Grid */
  .villager-grid-horizontal {
    width: 100% !important;
  }

  /* Hide fixed nav arrows on mobile - swipe replaces them */
  .letter-nav-arrow {
    display: none !important;
  }

  /* Hide prev/next arrows inside the alphabet nav bar */
  .villager-grid-horizontal .alphabet-nav-top button:first-child,
  .villager-grid-horizontal .alphabet-nav-top button:last-child {
    display: none !important;
  }

  /* Compact podium on mobile */
  .villager-grid-horizontal > div:first-child {
    margin-bottom: 12px !important;
  }

  .villager-grid-horizontal > div:first-child h2 {
    font-size: 13px !important;
    margin-bottom: 8px !important;
  }

  .villager-grid-horizontal > div:first-child > div {
    gap: 8px !important;
    padding: 0 8px !important;
  }

  /* A-Z nav: fit all 26 letters across screen, no box */
  .villager-grid-horizontal .alphabet-nav-top {
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: 0px !important;
    padding: 4px 0 !important;
    background: none !important;
    border-radius: 0 !important;
    border: none !important;
    margin-bottom: 10px !important;
    overflow-x: hidden !important;
    flex-wrap: nowrap !important;
    width: 100% !important;
  }

  .villager-grid-horizontal .alphabet-nav-top::-webkit-scrollbar {
    display: none !important;
  }

  .villager-grid-horizontal .alphabet-letters {
    display: flex !important;
    gap: 8px !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }

  .villager-grid-horizontal .nav-arrow {
    min-width: 40px !important;
    height: 40px !important;
    border: none !important;
    background: rgba(99,102,241,0.2) !important;
    color: white !important;
    border-radius: 8px !important;
    font-size: 20px !important;
    font-weight: bold !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    flex-shrink: 0 !important;
  }

  .villager-grid-horizontal .nav-arrow:hover:not(:disabled) {
    background: rgba(99,102,241,0.4) !important;
    transform: scale(1.1) !important;
  }

  .villager-grid-horizontal .nav-arrow:disabled {
    opacity: 0.3 !important;
    cursor: not-allowed !important;
  }

  .villager-grid-horizontal .alphabet-btn-top {
    min-width: 18px !important;
    width: 18px !important;
    height: 22px !important;
    font-size: 10px !important;
    border: none !important;
    background: transparent !important;
    color: white !important;
    border-radius: 0 !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    flex-shrink: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  .villager-grid-horizontal .alphabet-btn-top.active {
    background: transparent !important;
    border: none !important;
    color: rgba(255,255,255,0.6) !important;
  }

  .villager-grid-horizontal .alphabet-btn-top.current {
    background: transparent !important;
    border: none !important;
    color: white !important;
  }

  .villager-grid-horizontal .alphabet-btn-top.disabled {
    opacity: 0.3 !important;
    cursor: not-allowed !important;
  }

  .villager-tile.highlighted {
    animation: highlightPulse 2s ease-in-out !important;
    box-shadow: 0 0 20px rgba(99,102,241,0.8) !important;
    border: 2px solid #818cf8 !important;
  }

  @keyframes highlightPulse {
    0% {
      transform: scale(1);
      box-shadow: 0 0 20px rgba(99,102,241,0.8);
    }
    50% {
      transform: scale(1.05);
      box-shadow: 0 0 30px rgba(99,102,241,1);
    }
    100% {
      transform: scale(1);
      box-shadow: 0 0 20px rgba(99,102,241,0.8);
    }
  }

  
  .horizontal-container {
    display: flex !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    scroll-snap-type: x mandatory !important;
    gap: 0 !important;
  }

  .letter-section-horizontal {
    min-width: 100vw !important;
    scroll-snap-align: start !important;
    padding: 0 20px !important;
  }

  .letter-header-horizontal {
    display: flex !important;
    align-items: baseline !important;
    justify-content: flex-start !important;
    gap: 10px !important;
    margin-bottom: 12px !important;
    padding: 0 !important;
    background: none !important;
    border: none !important;
    border-radius: 0 !important;
    backdrop-filter: none !important;
  }

  .letter-header-horizontal h2 {
    font-size: 22px !important;
    font-weight: 700 !important;
    color: white !important;
    margin: 0 !important;
    letter-spacing: 0 !important;
    text-shadow: none !important;
  }

  .letter-count {
    font-size: 12px !important;
    color: rgba(255,255,255,0.45) !important;
    font-weight: 400 !important;
  }

  .letter-header-horizontal h2 {
    margin: 0 !important;
    font-size: 32px !important;
    font-weight: 800 !important;
    color: white !important;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3) !important;
    letter-spacing: 1px !important;
  }

  .letter-count {
    font-size: 16px !important;
    color: rgba(255,255,255,0.9) !important;
    font-weight: 600 !important;
    background: rgba(255,255,255,0.1) !important;
    padding: 8px 16px !important;
    border-radius: 20px !important;
    border: 1px solid rgba(255,255,255,0.2) !important;
  }

  .letter-grid-horizontal {
    display: grid !important;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)) !important;
    gap: 16px !important;
  }

  @media (max-width: 768px) {
    .alphabet-btn-top {
      min-width: 32px !important;
      height: 32px !important;
      font-size: 14px !important;
    }

    .letter-header-horizontal h2 {
      font-size: 24px !important;
    }

    .letter-grid-horizontal {
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)) !important;
      gap: 12px !important;
    }

    .letter-section-horizontal {
      padding: 0 16px !important;
    }
  }

  /* Alphabet Navigation */
  .alphabet-nav {
    display: flex !important;
    gap: 4px !important;
    padding: 16px 0 !important;
    justify-content: center !important;
    border-bottom: 1px solid rgba(255,255,255,0.1) !important;
    margin-bottom: 20px !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }

  .alphabet-btn {
    min-width: 32px !important;
    height: 32px !important;
    border: 1px solid rgba(255,255,255,0.2) !important;
    background: rgba(255,255,255,0.05) !important;
    color: rgba(255,255,255,0.6) !important;
    border-radius: 6px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    padding: 0 8px !important;
    flex-shrink: 0 !important;
  }

  .alphabet-btn.active {
    background: rgba(99,102,241,0.2) !important;
    border-color: rgba(99,102,241,0.4) !important;
    color: #818cf8 !important;
  }

  .alphabet-btn.disabled {
    opacity: 0.3 !important;
    cursor: not-allowed !important;
  }

  .alphabet-btn:hover:not(.disabled) {
    background: rgba(255,255,255,0.1) !important;
    border-color: rgba(255,255,255,0.3) !important;
    color: white !important;
  }

  .letter-section {
    margin-bottom: 32px !important;
    scroll-margin-top: 80px !important;
  }

  .letter-header {
    color: white !important;
    font-size: 24px !important;
    font-weight: 600 !important;
    margin: 0 0 16px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 2px solid rgba(99,102,241,0.3) !important;
  }

  .letter-grid {
    display: grid !important;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)) !important;
    gap: 16px !important;
  }

  @media (max-width: 768px) {
    .alphabet-nav {
      gap: 2px !important;
      padding: 12px 0 !important;
    }

    .alphabet-btn {
      min-width: 28px !important;
      height: 28px !important;
      font-size: 11px !important;
      padding: 0 6px !important;
    }

    .letter-grid {
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)) !important;
      gap: 12px !important;
    }

    .letter-section {
      scroll-margin-top: 60px !important;
    }
  }

  /* Nav row inside dropdown */
  .mobnav-nav {
    display: flex;
    flex-direction: row;
    justify-content: space-around;
    gap: 4px;
    padding-bottom: 16px;
    border-bottom: 1px solid rgba(255,255,255,0.08);
    margin-bottom: 16px;
  }
  .mobnav-nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 8px 6px;
    border-radius: 12px;
    background: none;
    border: none;
    color: rgba(255,255,255,0.45);
    cursor: pointer;
    flex: 1;
    transition: all 0.15s;
  }
  .mobnav-nav-item.active {
    color: white;
    background: rgba(255,255,255,0.09);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.1);
  }
  .mobnav-nav-item:hover { color: white; }
  .mobnav-nav-icon { font-size: 20px; line-height: 1; }
  .mobnav-nav-label { font-size: 10px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 56px; }

  /* Filter sections */
  .mobnav-filters { display: flex; flex-direction: column; gap: 14px; }
  .mobnav-filter-section { display: flex; flex-direction: column; gap: 6px; }
  .mobnav-filter-label {
    font-size: 10px; font-weight: 700; text-transform: uppercase;
    letter-spacing: 0.5px; color: rgba(255,255,255,0.3);
  }
  .mobnav-search-row {
    display: flex; align-items: center; gap: 8px;
    background: rgba(255,255,255,0.07);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 12px;
    padding: 8px 12px;
  }
  .mobnav-search-icon { font-size: 14px; opacity: 0.5; }
  .mobnav-search-input {
    flex: 1; background: none; border: none; color: white;
    font-size: 15px; outline: none;
  }
  .mobnav-search-input::placeholder { color: rgba(255,255,255,0.3); }
  .mobnav-clear {
    background: none; border: none; color: rgba(255,255,255,0.4);
    font-size: 16px; cursor: pointer; padding: 0;
  }
  .mobnav-pills-row {
    display: flex; flex-wrap: wrap; gap: 6px;
  }
  .mobnav-fpill {
    display: inline-flex; align-items: center; gap: 4px;
    padding: 6px 12px; border-radius: 20px;
    border: 1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.05);
    color: rgba(255,255,255,0.6);
    font-size: 12px; font-weight: 600;
    cursor: pointer; transition: all 0.12s;
  }
  .mobnav-fpill:hover { background: rgba(255,255,255,0.1); color: white; }
  .mobnav-fpill.active { background: rgba(167,139,250,0.16); border-color: rgba(167,139,250,0.45); color: #c4b5fd; box-shadow: 0 0 8px rgba(167,139,250,0.15); }
  .mobnav-fpill.small { font-size: 11px; padding: 4px 10px; }
  .mobnav-reset {
    background: none; border: 1px solid rgba(239,68,68,0.3);
    border-radius: 10px; color: #f87171; font-size: 12px;
    padding: 8px 14px; cursor: pointer; align-self: flex-start;
  }

  /* Hide all old sidebar elements on mobile */
  .sidebar { display: none !important; }
  .psb-sidebar { display: none !important; }
  .tsb-sidebar { display: none !important; }
  .fb-sidebar  { display: none !important; }
  .sidebar-mobile-tab { display: none !important; }
  .psb-mobile-bar { display: none !important; }
  .psb-mobile-backdrop { display: none !important; }
  .mobile-search-bar { display: none !important; }
  .main-content.with-sidebar { margin-left: 0 !important; }

  /* Push page content down below the pill — fixed 64px clearance, no env() */
  .main-content { padding-top: 64px !important; }
  .profile-page, .trades-page, .admin-page, .feedback-page {
    padding-top: 64px !important;
  }

  /* Prevent anything bleeding outside viewport horizontally */
  body, .app-bg, .min-h-screen, .main-content, .villager-grid-horizontal {
    overflow-x: hidden !important;
    max-width: 100vw !important;
  }

  /* Side/bottom padding — fixed values only, no env() */
  .profile-page,
  .trades-page,
  .admin-page,
  .feedback-page,
  .main-content {
    padding-left:   16px !important;
    padding-right:  16px !important;
    padding-bottom: 24px !important;
  }

  /* Trade tabs: all 4 on one line */
  .tr-tabs {
    display: flex !important;
    flex-direction: row !important;
    gap: 4px !important;
  }

  /* ── Shop sidebar: full-screen overlay, starts CLOSED ── */
  .sidebar {
    position: fixed !important;
    top: 0 !important; left: 0 !important;
    right: 0 !important;
    height: 100dvh !important;
    width: 100vw !important;
    border-radius: 0 !important;
    z-index: 600 !important;
    transform: translateX(-100vw) !important;
    transition: transform 0.25s ease;
    overflow-y: auto !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
  }
  .sidebar.open {
    transform: translateX(0) !important;
  }
  .sidebar-shell {
    min-height: 100% !important;
    border-radius: 0 !important;
  }
  /* Hide search inside sidebar shell on mobile — mobile search bar is inline in page */
  .sidebar-shell .sidebar-search-wrap { display: none !important; }

  .main-content.with-sidebar { margin-left: 0 !important; }
  .main-content { padding-top: 64px !important; }

  /* Hide desktop sidebar-toggle on mobile (it's inside transformed container so can't escape) */
  .sidebar-toggle { display: none !important; }

  /* ── sidebar-mobile-tab: fixed ▶/◀ tab on left edge, always visible ── */
  .sidebar-mobile-tab {
    display: flex !important;
    position: fixed !important;
    top: 50% !important;
    left: 0 !important;
    transform: translateY(-50%) !important;
    z-index: 700 !important;
    width: 28px !important;
    height: 48px !important;
    background: rgba(20,28,8,0.92) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(255,255,255,0.15) !important;
    border-left: none !important;
    border-radius: 0 10px 10px 0 !important;
    color: rgba(255,255,255,0.8) !important;
    font-size: 10px !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
    box-shadow: 2px 0 12px rgba(0,0,0,0.4) !important;
    padding: 0 !important;
  }

  /* ── Profile + Trades sidebars: hidden on mobile, MobileNav replaces them ── */
  .psb-sidebar,
  .tsb-sidebar {
    display: none !important;
  }
  .psb-sidebar.mobile-open,
  .tsb-sidebar.mobile-open {
    display: flex !important;
    position: fixed !important;
    top: 0 !important; left: 0 !important;
    right: 0 !important;
    height: 100dvh !important;
    width: 100vw !important;
    border-radius: 0 !important;
    z-index: 600 !important;
    overflow-y: auto !important;
    padding: 24px 20px !important;
    flex-direction: column !important;
    transform: none !important;
  }

  .psb-sidebar-inner,
  .tsb-sidebar-inner {
    padding: 0 !important;
    overflow: visible !important;
    min-height: unset !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    width: 100% !important;
  }

  /* Centre ALL content inside sidebars on mobile web */
  .tsb-sidebar .tsb-header { justify-content: center !important; text-align: center !important; width: 100% !important; }
  .tsb-sidebar .tsb-section { align-items: center !important; text-align: center !important; width: 100% !important; }
  .tsb-sidebar .tsb-section-label { text-align: center !important; width: 100% !important; }
  .tsb-sidebar .tsb-title { text-align: center !important; }
  .tsb-sidebar .tsb-summary { text-align: center !important; width: 100% !important; }
  .tsb-sidebar .tsb-villager-pills { justify-content: center !important; width: 100% !important; }
  .tsb-sidebar .tsb-filter-pill { text-align: center !important; }
  .tsb-sidebar .tsb-villager-input { text-align: center !important; width: 100% !important; }
  .tsb-sidebar .tsb-sidebar-inner { align-items: center !important; }

  /* Centre ProfileSidebar content on mobile web */
  .psb-sidebar .psb-tabs { justify-content: center !important; width: 100% !important; }
  .psb-sidebar .psb-results,
  .psb-sidebar .psb-friends-panel { align-items: center !important; width: 100% !important; }
  .psb-sidebar .psb-result-row,
  .psb-sidebar .psb-friend-row { width: 100% !important; }
  .psb-sidebar .psb-search-input { text-align: center !important; width: 100% !important; }
  .psb-sidebar .psb-sidebar-inner { align-items: center !important; }

  /* Centre Shop sidebar content on mobile web */
  .sidebar.open .sidebar-inner { display: flex !important; flex-direction: column !important; align-items: center !important; }
  .sidebar.open .filter-section { width: 100% !important; text-align: center !important; }
  .sidebar.open .filter-section-header { justify-content: center !important; }
  .sidebar.open .filter-pills { justify-content: center !important; }

  /* Backdrop */
  .psb-mobile-backdrop {
    display: block !important;
    position: fixed !important;
    inset: 0 !important;
    background: rgba(0,0,0,0.6) !important;
    z-index: 599 !important;
  }

  /* Shop mobile search bar — inline, scrolls with content */
  .mobile-search-bar {
    display: flex !important;
    position: static !important;
    padding: 0 0 12px;
    gap: 8px; align-items: center;
  }
  .mobile-search-bar input {
    flex: 1;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 12px;
    padding: 8px 12px;
    color: white; font-size: 15px; outline: none;
  }
  .mobile-search-bar input::placeholder { color: rgba(255,255,255,0.35); }
  .mobile-search-clear {
    background: none; border: none;
    color: rgba(255,255,255,0.5);
    font-size: 18px; cursor: pointer; padding: 0 4px;
  }

  /* Nav inside sidebar on mobile: centre-aligned, labels always visible */
  .psb-sidebar .sidebar-nav,
  .tsb-sidebar .sidebar-nav,
  .sidebar-shell .sidebar-nav {
    position: sticky !important;
    bottom: 0 !important;
    background: rgba(10,20,8,0.98) !important;
    margin-top: auto !important;
    padding-bottom: 14px !important;
  }
  .psb-sidebar .sidebar-nav-item,
  .tsb-sidebar .sidebar-nav-item,
  .sidebar-shell .sidebar-nav-item {
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
  }
  .psb-sidebar .nav-item-label,
  .tsb-sidebar .nav-item-label,
  .sidebar-shell .nav-item-label {
    opacity: 1 !important;
    font-size: 10px !important;
    white-space: nowrap !important;
  }
  .psb-sidebar .nav-item-icon,
  .tsb-sidebar .nav-item-icon,
  .sidebar-shell .nav-item-icon {
    font-size: 18px !important;
    line-height: 1 !important;
    filter: grayscale(1) brightness(10) !important;
    opacity: 0.6 !important;
  }

  /* Card action buttons always visible — touch devices can't hover */
  .card-top-actions,
  .corner-actions { opacity: 1 !important; }
  .corner-btn { opacity: 0.35 !important; filter: grayscale(1) !important; }
  .corner-btn.owned-active,
  .corner-btn.fav-active,
  .corner-btn.wish-active { opacity: 1 !important; filter: none !important; }
  .card-top-btn { color: rgba(255,255,255,0.25); filter: grayscale(1) opacity(0.3); }
  .card-top-btn.owned-active { color: #22c55e !important; filter: grayscale(0) opacity(1) !important; }
  .card-top-btn.fav-active   { color: #ef4444 !important; filter: grayscale(0) opacity(1) !important; }
  .card-top-btn.wish-active  { color: #fbbf24 !important; filter: grayscale(0) opacity(1) !important; }
  .card-top-btn.in-cart      { color: rgba(239,68,68,0.9) !important; filter: grayscale(0) opacity(1) !important; }

  /* ── Hide page titles / heroes on mobile ── */
  .pro-hero            { display: none !important; }
  .admin-header        { display: none !important; }
  .feedback-header     { display: none !important; }

  /* ── Gold user ID pill — top-right of each page ── */
  .mobile-user-pill {
    display: flex !important;
    position: fixed !important;
    top: 12px !important;
    right: 14px !important;
    z-index: 699 !important;
    align-items: center !important;
    gap: 5px !important;
    background: linear-gradient(135deg, #b8860b 0%, #ffd700 60%, #b8860b 100%) !important;
    color: #1a1000 !important;
    font-size: 11px !important;
    font-weight: 800 !important;
    border-radius: 20px !important;
    padding: 5px 11px !important;
    box-shadow: 0 2px 12px rgba(255,215,0,0.35), inset 0 1px 0 rgba(255,255,255,0.3) !important;
    letter-spacing: 0.3px !important;
    white-space: nowrap !important;
    border: 1px solid rgba(255,215,0,0.5) !important;
  }
  .mobile-user-pill-icon { font-size: 12px !important; }

  /* Profile hero: hidden on mobile (replaced by pill) */
  .pro-favs-col { width: 100% !important; align-items: center !important; }
  .pro-favs-row { flex-wrap: wrap !important; justify-content: center !important; gap: 6px !important; }
  .pro-fav-stat { min-width: 52px !important; }
  .pro-stats { flex-wrap: wrap !important; }

  /* Admin mobile: stack everything in a column */
  .admin-layout {
    flex-direction: column !important;
  }
  .admin-mobile-tabs-wrap {
    margin-top: 64px !important;
    padding: 0 16px 8px !important;
    overflow-x: auto;
    width: 100% !important;
  }
  .admin-mobile-tabs-wrap .admin-sb-tabs {
    flex-wrap: nowrap !important;
    gap: 4px !important;
  }
  .admin-sb-list-mobile {
    max-height: 300px !important;
  }
  .admin-main-detail {
    max-width: 100% !important;
    margin-top: 16px !important;
  }
  .admin-mobile-actions {
    margin-top: 12px !important;
  }

  /* Profile: viewing another user on mobile — show hero properly */
  .pro-view-other .pro-hero {
    display: flex !important;
    flex-direction: column !important;
    align-items: flex-start !important;
    gap: 12px !important;
  }
  .pro-view-other .pro-hero-left {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
  }
  .pro-view-other .pro-name {
    font-size: 18px !important;
    display: block !important;
  }
  .pro-view-other .pro-id-chip {
    display: inline-block !important;
  }
  .pro-view-other .pro-favs-col {
    width: 100% !important;
  }

  /* mobile-user-pill as button — keep gold pill look */
  button.mobile-user-pill {
    display: flex !important;
    cursor: pointer !important;
    outline: none !important;
    font-family: inherit !important;
  }

  /* Feedback page mobile */
  .fb-main {
    margin-left: 0 !important;
    padding: 24px 16px 80px !important;
    align-items: flex-start !important;
  }

  /* fb-sidebar: full-screen overlay, same as psb/tsb sidebars */
  .fb-sidebar {
    position: fixed !important;
    top: 0 !important; left: 0 !important;
    right: 0 !important;
    height: 100dvh !important;
    width: 100vw !important;
    border-radius: 0 !important;
    z-index: 600 !important;
    transform: translateX(-100vw) !important;
    transition: transform 0.25s ease;
    overflow-y: auto !important;
    padding: 24px 20px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
  }
  .fb-sidebar.mobile-open {
    transform: translateX(0) !important;
  }
  /* fb-sidebar layout on mobile: history fills space, nav pins to bottom */
  .fb-sidebar .fb-history {
    flex: 1 !important;
    width: 100% !important;
    text-align: center !important;
    overflow-y: auto !important;
  }
  .fb-sidebar .sidebar-nav {
    width: 100% !important;
    margin-top: auto !important;
    flex-shrink: 0 !important;
    position: sticky !important;
    bottom: 0 !important;
    background: rgba(10,20,8,0.98) !important;
    padding-bottom: 14px !important;
  }
  .fb-sidebar .sidebar-nav-item { flex-direction: column !important; align-items: center !important; text-align: center !important; }
  .fb-sidebar .nav-item-label { opacity: 1 !important; font-size: 10px !important; }
  .fb-sidebar .nav-item-icon { font-size: 18px !important; line-height: 1 !important; filter: grayscale(1) brightness(10) !important; opacity: 0.6 !important; }
}

/* ===== MOBILE FAVOURITES STRIP ===== */
.pro-favs-col-hidden-mobile {
  display: none !important;
}
.pro-favs-mobile-strip {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
  padding: 10px 14px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 14px;
  margin-bottom: 12px;
}

/* ===== MOBILE COMPACT PROFILE HEADER ===== */
.pro-mobile-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 16px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 18px;
  margin-bottom: 16px;
}
.pro-mobile-header-left {
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  flex: 1;
  min-width: 0;
}
.pro-mobile-name {
  color: white;
  font-size: 14px;
  font-weight: 700;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  cursor: pointer;
}
.pro-mobile-header-right {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-shrink: 0;
}

/* ===== WHITE FLASH FIX — prevent repaint on scroll ===== */
.app-bg-overlay {
  transform: translateZ(0);
  backface-visibility: hidden;
  will-change: auto;
}
.villager-grid {
  transform: translateZ(0);
}

/* ===== RESTRICTION BANNER ===== */
.restriction-banner {
  position: sticky;
  top: 0;
  z-index: 900;
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 12px 20px;
  background: linear-gradient(90deg, rgba(239,68,68,0.18) 0%, rgba(220,38,38,0.12) 100%);
  border-bottom: 1px solid rgba(239,68,68,0.3);
  backdrop-filter: blur(8px);
}
.restriction-banner-icon {
  font-size: 18px;
  flex-shrink: 0;
  margin-top: 1px;
}
.restriction-banner-text {
  color: rgba(255,200,200,0.9);
  font-size: 12px;
  line-height: 1.5;
}
.restriction-banner-text strong {
  color: #fca5a5;
}

/* ===== CHECKOUT OFFER AMOUNT INPUT ===== */
.checkout-offer-amount {
  -moz-appearance: textfield;
  appearance: textfield;
}
.checkout-offer-amount::-webkit-inner-spin-button,
.checkout-offer-amount::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* ===== INCOMING TRADE CARD IMPROVEMENTS ===== */
.tr-card-incoming {
  border-left: 3px solid rgba(167,139,250,0.5);
}
.tr-card-incoming .tr-card-stripe {
  background: linear-gradient(180deg, #a78bfa, #7c3aed);
}
.tr-card-accept-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 7px 14px;
  background: rgba(167,139,250,0.15);
  border: 1px solid rgba(167,139,250,0.3);
  border-radius: 10px;
  color: #a78bfa;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease;
  white-space: nowrap;
  flex-shrink: 0;
}
.tr-card-accept-btn:hover:not(:disabled) {
  background: rgba(167,139,250,0.25);
  transform: translateY(-1px);
}
.tr-card-accept-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}
.tr-card-decline-btn {
  padding: 7px 10px;
  background: transparent;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 10px;
  color: rgba(255,255,255,0.3);
  font-size: 11px;
  cursor: pointer;
  transition: all 0.15s ease;
}
.tr-card-decline-btn:hover:not(:disabled) {
  color: rgba(248,113,113,0.7);
  border-color: rgba(248,113,113,0.2);
}

/* ===== PROGRESS BAR always-visible tweak ===== */
.tr-progress-bar-wrap {
  padding: 10px 20px 0;
}
.tr-ongoing-card:not(.expanded) .tr-progress-bar-wrap {
  padding-bottom: 14px;
}

/* Trade rating UI */
.tr-star-btn {
  background: none;
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
}
.tr-star-btn:hover {
  border-color: rgba(251,191,36,0.5);
  transform: scale(1.1);
}
.tr-star-btn.active {
  border-color: #fbbf24;
  background: rgba(251,191,36,0.1);
}
.tr-rating-btn {
  background: rgba(251,191,36,0.1);
  border: 1px solid rgba(251,191,36,0.3);
  color: #fbbf24;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.85em;
  transition: all 0.2s;
}
.tr-rating-btn:hover {
  background: rgba(251,191,36,0.2);
  border-color: #fbbf24;
}
.tr-rating-row textarea {
  min-height: 50px;
  resize: vertical;
}
